import e from"buffer";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function r(e,t){return e(t={exports:{}},t.exports),t.exports}var i={},o="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e},s=/%[sdj%]/g;function u(e){if(!b(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(a(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,i=r.length,o=String(e).replace(s,function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),u=r[n];n<i;u=r[++n])N(u)||!A(u)?o+=" "+u:o+=" "+a(u);return o}var f,l={};function a(e,t){var n={seen:[],stylize:h};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),B(t)?n.showHidden=t:t&&v(n,t),y(n.showHidden)&&(n.showHidden=!1),y(n.depth)&&(n.depth=2),y(n.colors)&&(n.colors=!1),y(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=c),_(n,e,n.depth)}function c(e,t){var n=a.styles[t];return n?"["+a.colors[n][0]+"m"+e+"["+a.colors[n][1]+"m":e}function h(e,t){return e}function _(e,t,n){if(e.customInspect&&t&&T(t.inspect)&&t.inspect!==a&&(!t.constructor||t.constructor.prototype!==t)){var r=t.inspect(n,e);return b(r)||(r=_(e,r,n)),r}var i=function(e,t){if(y(t))return e.stylize("undefined","undefined");if(b(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(O(t))return e.stylize(""+t,"number");if(B(t))return e.stylize(""+t,"boolean");if(N(t))return e.stylize("null","null")}(e,t);if(i)return i;var o=Object.keys(t),s=function(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(t)),E(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return g(t);if(0===o.length){if(T(t)){var u=t.name?": "+t.name:"";return e.stylize("[Function"+u+"]","special")}if(S(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(m(t))return e.stylize(Date.prototype.toString.call(t),"date");if(E(t))return g(t)}var f,l="",c=!1,h=["{","}"];(p(t)&&(c=!0,h=["[","]"]),T(t))&&(l=" [Function"+(t.name?": "+t.name:"")+"]");return S(t)&&(l=" "+RegExp.prototype.toString.call(t)),m(t)&&(l=" "+Date.prototype.toUTCString.call(t)),E(t)&&(l=" "+g(t)),0!==o.length||c&&0!=t.length?n<0?S(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),f=c?function(e,t,n,r,i){for(var o=[],s=0,u=t.length;s<u;++s)R(t,String(s))?o.push(d(e,t,n,r,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(d(e,t,n,r,i,!0))}),o}(e,t,n,s,o):o.map(function(r){return d(e,t,n,s,r,c)}),e.seen.pop(),function(e,t,n){if(e.reduce(function(e,t){return t.indexOf("\n")>=0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(f,l,h)):h[0]+l+h[1]}function g(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,i,o){var s,u,f;if((f=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?u=f.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):f.set&&(u=e.stylize("[Setter]","special")),R(r,i)||(s="["+i+"]"),u||(e.seen.indexOf(f.value)<0?(u=N(n)?_(e,f.value,null):_(e,f.value,n-1)).indexOf("\n")>-1&&(u=o?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n")):u=e.stylize("[Circular]","special")),y(s)){if(o&&i.match(/^\d+$/))return u;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+u}function p(e){return Array.isArray(e)}function B(e){return"boolean"==typeof e}function N(e){return null===e}function O(e){return"number"==typeof e}function b(e){return"string"==typeof e}function y(e){return void 0===e}function S(e){return A(e)&&"[object RegExp]"===D(e)}function A(e){return"object"===babelHelpers.typeof(e)&&null!==e}function m(e){return A(e)&&"[object Date]"===D(e)}function E(e){return A(e)&&("[object Error]"===D(e)||e instanceof Error)}function T(e){return"function"==typeof e}function D(e){return Object.prototype.toString.call(e)}function w(e){return e<10?"0"+e.toString(10):e.toString(10)}a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function v(e,t){if(!t||!A(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}function R(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var L={inherits:o,_extend:v,log:function(){console.log("%s - %s",function(){var e=new Date,t=[w(e.getHours()),w(e.getMinutes()),w(e.getSeconds())].join(":");return[e.getDate(),I[e.getMonth()],t].join(" ")}(),u.apply(null,arguments))},isBuffer:function(e){return Buffer.isBuffer(e)},isPrimitive:function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"===babelHelpers.typeof(e)||void 0===e},isFunction:T,isError:E,isDate:m,isObject:A,isRegExp:S,isUndefined:y,isSymbol:function(e){return"symbol"===babelHelpers.typeof(e)},isString:b,isNumber:O,isNullOrUndefined:function(e){return null==e},isNull:N,isBoolean:B,isArray:p,inspect:a,deprecate:function e(t,n){if(y(global.process))return function(){return e(t,n).apply(this,arguments)};var r=!1;return function(){return r||(console.error(n),r=!0),t.apply(this,arguments)}},format:u,debuglog:function(e){y(f)&&(f=""),e=e.toUpperCase(),l[e]||(new RegExp("\\b"+e+"\\b","i").test(f)?l[e]=function(){var t=u.apply(null,arguments);console.error("%s %d: %s",e,0,t)}:l[e]=function(){});return l[e]}},U=r(function(n,r){function o(t){const n=e.Buffer.alloc(t);for(let e=0;e<t;++e)n[e]=Math.floor(256*Math.random());return n}if(Object.defineProperty(r,"__esModule",{value:!0}),r.deprecate=r.isObjectLike=r.isDate=r.isBuffer=r.haveBuffer=r.isBigUInt64Array=r.isBigInt64Array=r.isUint8Array=r.randomBytes=r.normalizedFunctionString=void 0,r.normalizedFunctionString=function(e){return e.toString().replace("function(","function (")},r.randomBytes=o,"undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues)r.randomBytes=(t=>window.crypto.getRandomValues(e.Buffer.alloc(t)));else{try{r.randomBytes=i.randomBytes}catch(e){}null==r.randomBytes&&(r.randomBytes=o)}function s(e){return"object"==typeof e&&null!==e}r.isUint8Array=function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)},r.isBigInt64Array=function(e){return"[object BigInt64Array]"===Object.prototype.toString.call(e)},r.isBigUInt64Array=function(e){return"[object BigUint64Array]"===Object.prototype.toString.call(e)},r.haveBuffer=function(){return void 0!==t&&void 0!==t.Buffer},r.isBuffer=function(e){var t;return"object"==typeof e&&"Buffer"===(null===(t=null===e||void 0===e?void 0:e.constructor)||void 0===t?void 0:t.name)},r.isDate=function(e){return s(e)&&"[object Date]"===Object.prototype.toString.call(e)},r.isObjectLike=s,r.deprecate=function(e,t){if("undefined"==typeof window||"undefined"==typeof self)return L.deprecate(e,t);let n=!1;return function(...r){return n||(console.warn(t),n=!0),e.apply(this,...r)}}});n(U);U.deprecate,U.isObjectLike,U.isDate,U.isBuffer,U.haveBuffer,U.isBigUInt64Array,U.isBigInt64Array,U.isUint8Array,U.randomBytes,U.normalizedFunctionString;var M=r(function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ensureBuffer=void 0,n.ensureBuffer=function(t){if(U.isBuffer(t))return t;if(ArrayBuffer.isView(t))return e.Buffer.from(t.buffer);if(t instanceof ArrayBuffer)return e.Buffer.from(t);throw new TypeError("Must use either Buffer or TypedArray")}});n(M);M.ensureBuffer;var j=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.parseUUID=void 0;const n=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;t.parseUUID=function(e){if("string"!=typeof e)throw new TypeError("Invalid type for UUID, expected string but got "+typeof e);if(!n.test(e))throw new TypeError("Invalid format for UUID: "+e);let t;const r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r}});n(j);j.parseUUID;var x=r(function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Binary=void 0;class r{constructor(t,n){if(!(null==t||"string"==typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||Array.isArray(t)))throw new TypeError("Binary can only be constructed from string, Buffer, TypedArray, or Array<number>");this.sub_type=null!==n&&void 0!==n?n:r.BSON_BINARY_SUBTYPE_DEFAULT,null==t?(this.buffer=e.Buffer.alloc(r.BUFFER_SIZE),this.position=0):("string"==typeof t?this.buffer=e.Buffer.from(t,"binary"):Array.isArray(t)?this.buffer=e.Buffer.from(t):this.buffer=M.ensureBuffer(t),this.position=this.buffer.byteLength)}put(t){if("string"==typeof t&&1!==t.length)throw new TypeError("only accepts single character String");if("number"!=typeof t&&1!==t.length)throw new TypeError("only accepts single character Uint8Array or Array");let n;if((n="string"==typeof t?t.charCodeAt(0):"number"==typeof t?t:t[0])<0||n>255)throw new TypeError("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.length>this.position)this.buffer[this.position++]=n;else{const t=e.Buffer.alloc(r.BUFFER_SIZE+this.buffer.length);this.buffer.copy(t,0,0,this.buffer.length),this.buffer=t,this.buffer[this.position++]=n}}write(t,n){if(n="number"==typeof n?n:this.position,this.buffer.length<n+t.length){const n=e.Buffer.alloc(this.buffer.length+t.length);this.buffer.copy(n,0,0,this.buffer.length),this.buffer=n}ArrayBuffer.isView(t)?(this.buffer.set(M.ensureBuffer(t),n),this.position=n+t.byteLength>this.position?n+t.length:this.position):"string"==typeof t&&(this.buffer.write(t,n,t.length,"binary"),this.position=n+t.length>this.position?n+t.length:this.position)}read(e,t){return t=t&&t>0?t:this.position,this.buffer.slice(e,e+t)}value(e){return(e=!!e)&&this.buffer.length===this.position?this.buffer:e?this.buffer.slice(0,this.position):this.buffer.toString("binary",0,this.position)}length(){return this.position}toJSON(){return this.buffer.toString("base64")}toString(e){return this.buffer.toString(e)}toExtendedJSON(e){e=e||{};const t=this.buffer.toString("base64"),n=Number(this.sub_type).toString(16);return e.legacy?{$binary:t,$type:1===n.length?"0"+n:n}:{$binary:{base64:t,subType:1===n.length?"0"+n:n}}}static fromExtendedJSON(t,n){let i,o;if(n=n||{},"$binary"in t?n.legacy&&"string"==typeof t.$binary&&"$type"in t?(o=t.$type?parseInt(t.$type,16):0,i=e.Buffer.from(t.$binary,"base64")):"string"!=typeof t.$binary&&(o=t.$binary.subType?parseInt(t.$binary.subType,16):0,i=e.Buffer.from(t.$binary.base64,"base64")):"$uuid"in t&&(o=4,i=e.Buffer.from(j.parseUUID(t.$uuid))),!i)throw new TypeError(`Unexpected Binary Extended JSON format ${JSON.stringify(t)}`);return new r(i,o)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`Binary("${this.value(!0).toString("hex")}", ${this.sub_type})`}}n.Binary=r,r.BSON_BINARY_SUBTYPE_DEFAULT=0,r.BUFFER_SIZE=256,r.SUBTYPE_DEFAULT=0,r.SUBTYPE_FUNCTION=1,r.SUBTYPE_BYTE_ARRAY=2,r.SUBTYPE_UUID_OLD=3,r.SUBTYPE_UUID=4,r.SUBTYPE_MD5=5,r.SUBTYPE_USER_DEFINED=128,Object.defineProperty(r.prototype,"_bsontype",{value:"Binary"})});n(x);x.Binary;var P=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Code=void 0;class n{constructor(e,t){this.code=e,this.scope=t}toJSON(){return{code:this.code,scope:this.scope}}toExtendedJSON(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}}static fromExtendedJSON(e){return new n(e.$code,e.$scope)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){const e=this.toJSON();return`Code("${e.code}"${e.scope?`, ${JSON.stringify(e.scope)}`:""})`}}t.Code=n,Object.defineProperty(n.prototype,"_bsontype",{value:"Code"})});n(P);P.Code;var Y=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DBRef=t.isDBRefLike=void 0,t.isDBRefLike=function(e){return U.isObjectLike(e)&&null!=e.$id&&null!=e.$ref};class n{constructor(e,t,n,r){const i=e.split(".");2===i.length&&(n=i.shift(),e=i.shift()),this.collection=e,this.oid=t,this.db=n,this.fields=r||{}}get namespace(){return this.collection}set namespace(e){this.collection=e}toJSON(){const e=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return null!=this.db&&(e.$db=this.db),e}toExtendedJSON(e){e=e||{};let t={$ref:this.collection,$id:this.oid};return e.legacy?t:(this.db&&(t.$db=this.db),t=Object.assign(t,this.fields))}static fromExtendedJSON(e){const t=Object.assign({},e);return delete t.$ref,delete t.$id,delete t.$db,new n(e.$ref,e.$id,e.$db,t)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){const e=void 0===this.oid||void 0===this.oid.toString?this.oid:this.oid.toString();return`DBRef("${this.namespace}", "${e}"${this.db?`, "${this.db}"`:""})`}}t.DBRef=n,Object.defineProperty(n.prototype,"_bsontype",{value:"DBRef"})});n(Y);Y.DBRef,Y.isDBRefLike;var $=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Long=void 0;let n=void 0;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}const r=4294967296,i=r*r,o=i/2,s={},u={};class f{constructor(e=0,t=0,n){this.low=0|e,this.high=0|t,this.unsigned=!!n,Object.defineProperty(this,"__isLong__",{value:!0,configurable:!1,writable:!1,enumerable:!1})}static fromBits(e,t,n){return new f(e,t,n)}static fromInt(e,t){let n,r,i;return t?(i=0<=(e>>>=0)&&e<256)&&(r=u[e])?r:(n=f.fromBits(e,(0|e)<0?-1:0,!0),i&&(u[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(r=s[e])?r:(n=f.fromBits(e,e<0?-1:0,!1),i&&(s[e]=n),n)}static fromNumber(e,t){if(isNaN(e))return t?f.UZERO:f.ZERO;if(t){if(e<0)return f.UZERO;if(e>=i)return f.MAX_UNSIGNED_VALUE}else{if(e<=-o)return f.MIN_VALUE;if(e+1>=o)return f.MAX_VALUE}return e<0?f.fromNumber(-e,t).neg():f.fromBits(e%r|0,e/r|0,t)}static fromBigInt(e,t){return f.fromString(e.toString(),t)}static fromString(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return f.ZERO;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");let r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return f.fromString(e.substring(1),t,n).neg();const i=f.fromNumber(Math.pow(n,8));let o=f.ZERO;for(let t=0;t<e.length;t+=8){const r=Math.min(8,e.length-t),s=parseInt(e.substring(t,t+r),n);if(r<8){const e=f.fromNumber(Math.pow(n,r));o=o.mul(e).add(f.fromNumber(s))}else o=(o=o.mul(i)).add(f.fromNumber(s))}return o.unsigned=t,o}static fromBytes(e,t,n){return n?f.fromBytesLE(e,t):f.fromBytesBE(e,t)}static fromBytesLE(e,t){return new f(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)}static fromBytesBE(e,t){return new f(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}static isLong(e){return U.isObjectLike(e)&&!0===e.__isLong__}static fromValue(e,t){return"number"==typeof e?f.fromNumber(e,t):"string"==typeof e?f.fromString(e,t):f.fromBits(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}add(e){f.isLong(e)||(e=f.fromValue(e));const t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,s=65535&e.high,u=e.low>>>16;let l=0,a=0,c=0,h=0;return c+=(h+=i+(65535&e.low))>>>16,h&=65535,a+=(c+=r+u)>>>16,c&=65535,l+=(a+=n+s)>>>16,a&=65535,l+=t+o,l&=65535,f.fromBits(c<<16|h,l<<16|a,this.unsigned)}and(e){return f.isLong(e)||(e=f.fromValue(e)),f.fromBits(this.low&e.low,this.high&e.high,this.unsigned)}compare(e){if(f.isLong(e)||(e=f.fromValue(e)),this.eq(e))return 0;const t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1}comp(e){return this.compare(e)}divide(e){if(f.isLong(e)||(e=f.fromValue(e)),e.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&-2147483648===this.high&&-1===e.low&&-1===e.high)return this;const t=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,e.low,e.high);return f.fromBits(t,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?f.UZERO:f.ZERO;let t,r,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return f.UZERO;if(e.gt(this.shru(1)))return f.UONE;i=f.UZERO}else{if(this.eq(f.MIN_VALUE)){if(e.eq(f.ONE)||e.eq(f.NEG_ONE))return f.MIN_VALUE;if(e.eq(f.MIN_VALUE))return f.ONE;return(t=this.shr(1).div(e).shl(1)).eq(f.ZERO)?e.isNegative()?f.ONE:f.NEG_ONE:(r=this.sub(e.mul(t)),i=t.add(r.div(e)))}if(e.eq(f.MIN_VALUE))return this.unsigned?f.UZERO:f.ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=f.ZERO}for(r=this;r.gte(e);){t=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));const n=Math.ceil(Math.log(t)/Math.LN2),o=n<=48?1:Math.pow(2,n-48);let s=f.fromNumber(t),u=s.mul(e);for(;u.isNegative()||u.gt(r);)t-=o,u=(s=f.fromNumber(t,this.unsigned)).mul(e);s.isZero()&&(s=f.ONE),i=i.add(s),r=r.sub(u)}return i}div(e){return this.divide(e)}equals(e){return f.isLong(e)||(e=f.fromValue(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)}eq(e){return this.equals(e)}getHighBits(){return this.high}getHighBitsUnsigned(){return this.high>>>0}getLowBits(){return this.low}getLowBitsUnsigned(){return this.low>>>0}getNumBitsAbs(){if(this.isNegative())return this.eq(f.MIN_VALUE)?64:this.neg().getNumBitsAbs();const e=0!==this.high?this.high:this.low;let t;for(t=31;t>0&&0==(e&1<<t);t--);return 0!==this.high?t+33:t+1}greaterThan(e){return this.comp(e)>0}gt(e){return this.greaterThan(e)}greaterThanOrEqual(e){return this.comp(e)>=0}gte(e){return this.greaterThanOrEqual(e)}ge(e){return this.greaterThanOrEqual(e)}isEven(){return 0==(1&this.low)}isNegative(){return!this.unsigned&&this.high<0}isOdd(){return 1==(1&this.low)}isPositive(){return this.unsigned||this.high>=0}isZero(){return 0===this.high&&0===this.low}lessThan(e){return this.comp(e)<0}lt(e){return this.lessThan(e)}lessThanOrEqual(e){return this.comp(e)<=0}lte(e){return this.lessThanOrEqual(e)}modulo(e){if(f.isLong(e)||(e=f.fromValue(e)),n){const t=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,e.low,e.high);return f.fromBits(t,n.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))}mod(e){return this.modulo(e)}rem(e){return this.modulo(e)}multiply(e){if(this.isZero())return f.ZERO;if(f.isLong(e)||(e=f.fromValue(e)),n){const t=n.mul(this.low,this.high,e.low,e.high);return f.fromBits(t,n.get_high(),this.unsigned)}if(e.isZero())return f.ZERO;if(this.eq(f.MIN_VALUE))return e.isOdd()?f.MIN_VALUE:f.ZERO;if(e.eq(f.MIN_VALUE))return this.isOdd()?f.MIN_VALUE:f.ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(f.TWO_PWR_24)&&e.lt(f.TWO_PWR_24))return f.fromNumber(this.toNumber()*e.toNumber(),this.unsigned);const t=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,s=e.high>>>16,u=65535&e.high,l=e.low>>>16,a=65535&e.low;let c=0,h=0,_=0,g=0;return _+=(g+=o*a)>>>16,g&=65535,h+=(_+=i*a)>>>16,_&=65535,h+=(_+=o*l)>>>16,_&=65535,c+=(h+=r*a)>>>16,h&=65535,c+=(h+=i*l)>>>16,h&=65535,c+=(h+=o*u)>>>16,h&=65535,c+=t*a+r*l+i*u+o*s,c&=65535,f.fromBits(_<<16|g,c<<16|h,this.unsigned)}mul(e){return this.multiply(e)}negate(){return!this.unsigned&&this.eq(f.MIN_VALUE)?f.MIN_VALUE:this.not().add(f.ONE)}neg(){return this.negate()}not(){return f.fromBits(~this.low,~this.high,this.unsigned)}notEquals(e){return!this.equals(e)}neq(e){return this.notEquals(e)}ne(e){return this.notEquals(e)}or(e){return f.isLong(e)||(e=f.fromValue(e)),f.fromBits(this.low|e.low,this.high|e.high,this.unsigned)}shiftLeft(e){return f.isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?f.fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):f.fromBits(0,this.low<<e-32,this.unsigned)}shl(e){return this.shiftLeft(e)}shiftRight(e){return f.isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?f.fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):f.fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)}shr(e){return this.shiftRight(e)}shiftRightUnsigned(e){if(f.isLong(e)&&(e=e.toInt()),0===(e&=63))return this;{const t=this.high;if(e<32){const n=this.low;return f.fromBits(n>>>e|t<<32-e,t>>>e,this.unsigned)}return 32===e?f.fromBits(t,0,this.unsigned):f.fromBits(t>>>e-32,0,this.unsigned)}}shr_u(e){return this.shiftRightUnsigned(e)}shru(e){return this.shiftRightUnsigned(e)}subtract(e){return f.isLong(e)||(e=f.fromValue(e)),this.add(e.neg())}sub(e){return this.subtract(e)}toInt(){return this.unsigned?this.low>>>0:this.low}toNumber(){return this.unsigned?(this.high>>>0)*r+(this.low>>>0):this.high*r+(this.low>>>0)}toBigInt(){return BigInt(this.toString())}toBytes(e){return e?this.toBytesLE():this.toBytesBE()}toBytesLE(){const e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]}toBytesBE(){const e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]}toSigned(){return this.unsigned?f.fromBits(this.low,this.high,!1):this}toString(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(f.MIN_VALUE)){const t=f.fromNumber(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}const t=f.fromNumber(Math.pow(e,6),this.unsigned);let n=this,r="";for(;;){const i=n.div(t);let o=(n.sub(i.mul(t)).toInt()>>>0).toString(e);if((n=i).isZero())return o+r;for(;o.length<6;)o="0"+o;r=""+o+r}}toUnsigned(){return this.unsigned?this:f.fromBits(this.low,this.high,!0)}xor(e){return f.isLong(e)||(e=f.fromValue(e)),f.fromBits(this.low^e.low,this.high^e.high,this.unsigned)}eqz(){return this.isZero()}le(e){return this.lessThanOrEqual(e)}toExtendedJSON(e){return e&&e.relaxed?this.toNumber():{$numberLong:this.toString()}}static fromExtendedJSON(e,t){const n=f.fromString(e.$numberLong);return t&&t.relaxed?n.toNumber():n}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`Long("${this.toString()}")`}}t.Long=f,f.TWO_PWR_24=f.fromInt(1<<24),f.MAX_UNSIGNED_VALUE=f.fromBits(-1,-1,!0),f.ZERO=f.fromInt(0),f.UZERO=f.fromInt(0,!0),f.ONE=f.fromInt(1),f.UONE=f.fromInt(1,!0),f.NEG_ONE=f.fromInt(-1),f.MAX_VALUE=f.fromBits(-1,2147483647,!1),f.MIN_VALUE=f.fromBits(0,-2147483648,!1),Object.defineProperty(f.prototype,"__isLong__",{value:!0}),Object.defineProperty(f.prototype,"_bsontype",{value:"Long"})});n($);$.Long;var C=r(function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Decimal128=void 0;const r=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,i=/^(\+|-)?(Infinity|inf)$/i,o=/^(\+|-)?NaN$/i,s=6111,u=-6176,f=6176,l=34,a=[124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),c=[248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),h=[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),_=/^([-+])?(\d+)?$/,g=31,d=16383,p=30,B=31;function N(e){return!isNaN(parseInt(e,10))}function O(e){const t=$.Long.fromNumber(1e9);let n=$.Long.fromNumber(0);if(!(e.parts[0]||e.parts[1]||e.parts[2]||e.parts[3]))return{quotient:e,rem:n};for(let r=0;r<=3;r++)n=(n=n.shiftLeft(32)).add(new $.Long(e.parts[r],0)),e.parts[r]=n.div(t).low,n=n.modulo(t);return{quotient:e,rem:n}}function b(e,t){throw new TypeError(`"${e}" is not a valid Decimal128 string - ${t}`)}class y{constructor(e){this.bytes=e}static fromString(t){let n=!1,g=!1,d=!1,p=0,B=0,O=0,S=0,A=0;const m=[0];let E=0,T=0,D=0,w=0,I=0,v=0,R=new $.Long(0,0),L=new $.Long(0,0),U=0,M=0;if(t.length>=7e3)throw new TypeError(t+" not a valid Decimal128 string");const j=t.match(r),x=t.match(i),P=t.match(o);if(!j&&!x&&!P||0===t.length)throw new TypeError(t+" not a valid Decimal128 string");if(j){const e=j[2],n=j[4],r=j[5],i=j[6];n&&void 0===i&&b(t,"missing exponent power"),n&&void 0===e&&b(t,"missing exponent base"),void 0===n&&(r||i)&&b(t,"missing e before exponent")}if("+"!==t[M]&&"-"!==t[M]||(n="-"===t[M++]),!N(t[M])&&"."!==t[M]){if("i"===t[M]||"I"===t[M])return new y(e.Buffer.from(n?c:h));if("N"===t[M])return new y(e.Buffer.from(a))}for(;N(t[M])||"."===t[M];)"."!==t[M]?(E<34&&("0"!==t[M]||d)&&(d||(A=B),d=!0,m[T++]=parseInt(t[M],10),E+=1),d&&(O+=1),g&&(S+=1),B+=1,M+=1):(g&&b(t,"contains multiple periods"),g=!0,M+=1);if(g&&!B)throw new TypeError(t+" not a valid Decimal128 string");if("e"===t[M]||"E"===t[M]){const n=t.substr(++M).match(_);if(!n||!n[2])return new y(e.Buffer.from(a));I=parseInt(n[0],10),M+=n[0].length}if(t[M])return new y(e.Buffer.from(a));if(D=0,E){if(w=E-1,1!==(p=O))for(;"0"===t[A+p-1];)p-=1}else D=0,w=0,m[0]=0,O=1,E=1,p=0;for(I<=S&&S-I>16384?I=u:I-=S;I>s;){if((w+=1)-D>l){if(m.join("").match(/^0+$/)){I=s;break}b(t,"overflow")}I-=1}for(;I<u||E<O;){if(0===w&&p<E){I=u,p=0;break}if(E<O?O-=1:w-=1,I<s)I+=1;else{if(m.join("").match(/^0+$/)){I=s;break}b(t,"overflow")}}if(w-D+1<p){let r=B;g&&(A+=1,r+=1),n&&(A+=1,r+=1);const i=parseInt(t[A+w+1],10);let o=0;if(i>=5&&(o=1,5===i))for(o=m[w]%2==1?1:0,v=A+w+2;v<r;v++)if(parseInt(t[v],10)){o=1;break}if(o){let t=w;for(;t>=0;t--)if(++m[t]>9&&(m[t]=0,0===t)){if(!(I<s))return new y(e.Buffer.from(n?c:h));I+=1,m[t]=1}}}if(R=$.Long.fromNumber(0),L=$.Long.fromNumber(0),0===p)R=$.Long.fromNumber(0),L=$.Long.fromNumber(0);else if(w-D<17){let e=D;for(L=$.Long.fromNumber(m[e++]),R=new $.Long(0,0);e<=w;e++)L=(L=L.multiply($.Long.fromNumber(10))).add($.Long.fromNumber(m[e]))}else{let e=D;for(R=$.Long.fromNumber(m[e++]);e<=w-17;e++)R=(R=R.multiply($.Long.fromNumber(10))).add($.Long.fromNumber(m[e]));for(L=$.Long.fromNumber(m[e++]);e<=w;e++)L=(L=L.multiply($.Long.fromNumber(10))).add($.Long.fromNumber(m[e]))}const Y=function(e,t){if(!e&&!t)return{high:$.Long.fromNumber(0),low:$.Long.fromNumber(0)};const n=e.shiftRightUnsigned(32),r=new $.Long(e.getLowBits(),0),i=t.shiftRightUnsigned(32),o=new $.Long(t.getLowBits(),0);let s=n.multiply(i),u=n.multiply(o);const f=r.multiply(i);let l=r.multiply(o);return s=s.add(u.shiftRightUnsigned(32)),u=new $.Long(u.getLowBits(),0).add(f).add(l.shiftRightUnsigned(32)),{high:s=s.add(u.shiftRightUnsigned(32)),low:l=u.shiftLeft(32).add(new $.Long(l.getLowBits(),0))}}(R,$.Long.fromString("100000000000000000"));Y.low=Y.low.add(L),function(e,t){const n=e.high>>>0,r=t.high>>>0;if(n<r)return!0;if(n===r&&e.low>>>0<t.low>>>0)return!0;return!1}(Y.low,L)&&(Y.high=Y.high.add($.Long.fromNumber(1))),U=I+f;const C={low:$.Long.fromNumber(0),high:$.Long.fromNumber(0)};Y.high.shiftRightUnsigned(49).and($.Long.fromNumber(1)).equals($.Long.fromNumber(1))?(C.high=C.high.or($.Long.fromNumber(3).shiftLeft(61)),C.high=C.high.or($.Long.fromNumber(U).and($.Long.fromNumber(16383).shiftLeft(47))),C.high=C.high.or(Y.high.and($.Long.fromNumber(0x7fffffffffff)))):(C.high=C.high.or($.Long.fromNumber(16383&U).shiftLeft(49)),C.high=C.high.or(Y.high.and($.Long.fromNumber(562949953421311)))),C.low=Y.low,n&&(C.high=C.high.or($.Long.fromString("9223372036854775808")));const z=e.Buffer.alloc(16);return M=0,z[M++]=255&C.low.low,z[M++]=C.low.low>>8&255,z[M++]=C.low.low>>16&255,z[M++]=C.low.low>>24&255,z[M++]=255&C.low.high,z[M++]=C.low.high>>8&255,z[M++]=C.low.high>>16&255,z[M++]=C.low.high>>24&255,z[M++]=255&C.high.low,z[M++]=C.high.low>>8&255,z[M++]=C.high.low>>16&255,z[M++]=C.high.low>>24&255,z[M++]=255&C.high.high,z[M++]=C.high.high>>8&255,z[M++]=C.high.high>>16&255,z[M++]=C.high.high>>24&255,new y(z)}toString(){let e,t=0;const n=new Array(36);for(let e=0;e<n.length;e++)n[e]=0;let r,i,o,s=0,u=!1,l={parts:[0,0,0,0]};const a=[];s=0;const c=this.bytes,h=c[s++]|c[s++]<<8|c[s++]<<16|c[s++]<<24,_=c[s++]|c[s++]<<8|c[s++]<<16|c[s++]<<24,N=c[s++]|c[s++]<<8|c[s++]<<16|c[s++]<<24,b=c[s++]|c[s++]<<8|c[s++]<<16|c[s++]<<24;s=0,{low:new $.Long(h,_),high:new $.Long(N,b)}.high.lessThan($.Long.ZERO)&&a.push("-");const y=b>>26&g;if(y>>3==3){if(y===p)return a.join("")+"Infinity";if(y===B)return"NaN";e=b>>15&d,r=8+(b>>14&1)}else r=b>>14&7,e=b>>17&d;const S=e-f;if(l.parts[0]=(16383&b)+((15&r)<<14),l.parts[1]=N,l.parts[2]=_,l.parts[3]=h,0===l.parts[0]&&0===l.parts[1]&&0===l.parts[2]&&0===l.parts[3])u=!0;else for(o=3;o>=0;o--){let e=0;const t=O(l);if(l=t.quotient,e=t.rem.low)for(i=8;i>=0;i--)n[9*o+i]=e%10,e=Math.floor(e/10)}if(u)t=1,n[s]=0;else for(t=36;!n[s];)t-=1,s+=1;const A=t-1+S;if(A>=34||A<=-7||S>0){if(t>34)return a.push("0"),S>0?a.push("E+"+S):S<0&&a.push("E"+S),a.join("");a.push(`${n[s++]}`),(t-=1)&&a.push(".");for(let e=0;e<t;e++)a.push(`${n[s++]}`);a.push("E"),A>0?a.push("+"+A):a.push(`${A}`)}else if(S>=0)for(let e=0;e<t;e++)a.push(`${n[s++]}`);else{let e=t+S;if(e>0)for(let t=0;t<e;t++)a.push(`${n[s++]}`);else a.push("0");for(a.push(".");e++<0;)a.push("0");for(let r=0;r<t-Math.max(e-1,0);r++)a.push(`${n[s++]}`)}return a.join("")}toJSON(){return{$numberDecimal:this.toString()}}toExtendedJSON(){return{$numberDecimal:this.toString()}}static fromExtendedJSON(e){return y.fromString(e.$numberDecimal)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`Decimal128("${this.toString()}")`}}n.Decimal128=y,Object.defineProperty(y.prototype,"_bsontype",{value:"Decimal128"})});n(C);C.Decimal128;var z=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Double=void 0;class n{constructor(e){e instanceof Number&&(e=e.valueOf()),this.value=+e}valueOf(){return this.value}toJSON(){return this.value}toExtendedJSON(e){if(e&&(e.legacy||e.relaxed&&isFinite(this.value)))return this.value;if(Object.is(Math.sign(this.value),-0))return{$numberDouble:`-${this.value.toFixed(1)}`};let t;return Number.isInteger(this.value)?(t=this.value.toFixed(1)).length>=13&&(t=this.value.toExponential(13).toUpperCase()):t=this.value.toString(),{$numberDouble:t}}static fromExtendedJSON(e,t){const r=parseFloat(e.$numberDouble);return t&&t.relaxed?r:new n(r)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`Double(${this.toExtendedJSON().$numberDouble})`}}t.Double=n,Object.defineProperty(n.prototype,"_bsontype",{value:"Double"})});n(z);z.Double;var J=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Int32=void 0;class n{constructor(e){e instanceof Number&&(e=e.valueOf()),this.value=+e}valueOf(){return this.value}toJSON(){return this.value}toExtendedJSON(e){return e&&(e.relaxed||e.legacy)?this.value:{$numberInt:this.value.toString()}}static fromExtendedJSON(e,t){return t&&t.relaxed?parseInt(e.$numberInt,10):new n(e.$numberInt)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`Int32(${this.valueOf()})`}}t.Int32=n,Object.defineProperty(n.prototype,"_bsontype",{value:"Int32"})});n(J);J.Int32;var F=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MaxKey=void 0;class n{toExtendedJSON(){return{$maxKey:1}}static fromExtendedJSON(){return new n}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return"MaxKey()"}}t.MaxKey=n,Object.defineProperty(n.prototype,"_bsontype",{value:"MaxKey"})});n(F);F.MaxKey;var K=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MinKey=void 0;class n{toExtendedJSON(){return{$minKey:1}}static fromExtendedJSON(){return new n}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return"MinKey()"}}t.MinKey=n,Object.defineProperty(n.prototype,"_bsontype",{value:"MinKey"})});n(K);K.MinKey;var k=r(function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ObjectId=void 0;const r=U.randomBytes(5),i=new RegExp("^[0-9a-fA-F]{24}$"),o=[];for(let e=0;e<256;e++)o[e]=(e<=15?"0":"")+e.toString(16);const s=[];let u=0;for(;u<10;)s[48+u]=u++;for(;u<16;)s[55+u]=s[87+u]=u++;const f=Symbol("id");class l{constructor(t){if(t instanceof l&&(this[f]=t.id,this.__id=t.__id),"object"==typeof t&&t&&"id"in t&&("toHexString"in t&&"function"==typeof t.toHexString?this[f]=e.Buffer.from(t.toHexString(),"hex"):this[f]="string"==typeof t.id?e.Buffer.from(t.id):t.id),null!=t&&"number"!=typeof t||(this[f]=l.generate("number"==typeof t?t:void 0),l.cacheHexString&&(this.__id=this.id.toString("hex"))),ArrayBuffer.isView(t)&&12===t.byteLength&&(this[f]=M.ensureBuffer(t)),"string"==typeof t)if(12===t.length){const n=e.Buffer.from(t);12===n.byteLength&&(this[f]=n)}else{if(24!==t.length||!i.test(t))throw new TypeError("Argument passed in must be a Buffer or string of 12 bytes or a string of 24 hex characters");this[f]=e.Buffer.from(t,"hex")}l.cacheHexString&&(this.__id=this.id.toString("hex"))}get id(){return this[f]}set id(e){this[f]=e,l.cacheHexString&&(this.__id=e.toString("hex"))}get generationTime(){return this.id.readInt32BE(0)}set generationTime(e){this.id.writeUInt32BE(e,0)}toHexString(){if(l.cacheHexString&&this.__id)return this.__id;const e=this.id.toString("hex");return l.cacheHexString&&!this.__id&&(this.__id=e),e}static getInc(){return l.index=(l.index+1)%16777215}static generate(t){"number"!=typeof t&&(t=~~(Date.now()/1e3));const n=l.getInc(),i=e.Buffer.alloc(12);return i.writeUInt32BE(t,0),i[4]=r[0],i[5]=r[1],i[6]=r[2],i[7]=r[3],i[8]=r[4],i[11]=255&n,i[10]=n>>8&255,i[9]=n>>16&255,i}toString(e){return e?this.id.toString(e):this.toHexString()}toJSON(){return this.toHexString()}equals(t){return void 0!==t&&null!==t&&(t instanceof l?this.toString()===t.toString():"string"==typeof t&&l.isValid(t)&&12===t.length&&this.id instanceof e.Buffer?t===this.id.toString("binary"):"string"==typeof t&&l.isValid(t)&&24===t.length?t.toLowerCase()===this.toHexString():"string"==typeof t&&l.isValid(t)&&12===t.length?e.Buffer.from(t).equals(this.id):"object"==typeof t&&"toHexString"in t&&"function"==typeof t.toHexString&&t.toHexString()===this.toHexString())}getTimestamp(){const e=new Date,t=this.id.readUInt32BE(0);return e.setTime(1e3*Math.floor(t)),e}static createPk(){return new l}static createFromTime(t){const n=e.Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0]);return n.writeUInt32BE(t,0),new l(n)}static createFromHexString(t){if(void 0===t||null!=t&&24!==t.length)throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");return new l(e.Buffer.from(t,"hex"))}static isValid(t){return null!=t&&("number"==typeof t||("string"==typeof t?12===t.length||24===t.length&&i.test(t):t instanceof l||(t instanceof e.Buffer&&12===t.length||"object"==typeof t&&"toHexString"in t&&"function"==typeof t.toHexString&&("string"==typeof t.id?12===t.id.length:24===t.toHexString().length&&i.test(t.id.toString("hex"))))))}toExtendedJSON(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}}static fromExtendedJSON(e){return new l(e.$oid)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`ObjectId("${this.toHexString()}")`}}n.ObjectId=l,l.index=~~(16777215*Math.random()),Object.defineProperty(l.prototype,"generate",{value:U.deprecate(e=>l.generate(e),"Please use the static `ObjectId.generate(time)` instead")}),Object.defineProperty(l.prototype,"getInc",{value:U.deprecate(()=>l.getInc(),"Please use the static `ObjectId.getInc()` instead")}),Object.defineProperty(l.prototype,"get_inc",{value:U.deprecate(()=>l.getInc(),"Please use the static `ObjectId.getInc()` instead")}),Object.defineProperty(l,"get_inc",{value:U.deprecate(()=>l.getInc(),"Please use the static `ObjectId.getInc()` instead")}),Object.defineProperty(l.prototype,"_bsontype",{value:"ObjectID"})});n(k);k.ObjectId;var X=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.BSONRegExp=void 0;class n{constructor(e,t){this.pattern=e,this.options=null!==t&&void 0!==t?t:"",function(e){e.split("").sort().join("")}(this.options);for(let e=0;e<this.options.length;e++)if("i"!==this.options[e]&&"m"!==this.options[e]&&"x"!==this.options[e]&&"l"!==this.options[e]&&"s"!==this.options[e]&&"u"!==this.options[e])throw new Error(`The regular expression option [${this.options[e]}] is not supported`)}static parseOptions(e){return e?e.split("").sort().join(""):""}toExtendedJSON(e){return(e=e||{}).legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}}static fromExtendedJSON(e){if("$regex"in e){if("string"==typeof e.$regex)return new n(e.$regex,n.parseOptions(e.$options));if("BSONRegExp"===e.$regex._bsontype)return e}if("$regularExpression"in e)return new n(e.$regularExpression.pattern,n.parseOptions(e.$regularExpression.options));throw new TypeError(`Unexpected BSONRegExp EJSON object form: ${JSON.stringify(e)}`)}}t.BSONRegExp=n,Object.defineProperty(n.prototype,"_bsontype",{value:"BSONRegExp"})});n(X);X.BSONRegExp;var V=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.BSONSymbol=void 0;class n{constructor(e){this.value=e}valueOf(){return this.value}toString(){return this.value}inspect(){return`BSONSymbol("${this.value}")`}toJSON(){return this.value}toExtendedJSON(){return{$symbol:this.value}}static fromExtendedJSON(e){return new n(e.$symbol)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}}t.BSONSymbol=n,Object.defineProperty(n.prototype,"_bsontype",{value:"Symbol"})});n(V);V.BSONSymbol;var W=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Timestamp=t.LongWithoutOverridesClass=void 0,t.LongWithoutOverridesClass=$.Long;class n extends t.LongWithoutOverridesClass{constructor(e,t){$.Long.isLong(e)?super(e.low,e.high,!0):super(e,t,!0),Object.defineProperty(this,"_bsontype",{value:"Timestamp",writable:!1,configurable:!1,enumerable:!1})}toJSON(){return{$timestamp:this.toString()}}static fromInt(e){return new n($.Long.fromInt(e,!0))}static fromNumber(e){return new n($.Long.fromNumber(e,!0))}static fromBits(e,t){return new n(e,t)}static fromString(e,t){return new n($.Long.fromString(e,!0,t))}toExtendedJSON(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}}static fromExtendedJSON(e){return new n(e.$timestamp.i,e.$timestamp.t)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`Timestamp(${this.getLowBits().toString()}, ${this.getHighBits().toString()})`}}t.Timestamp=n,n.MAX_VALUE=$.Long.MAX_UNSIGNED_VALUE});n(W);W.Timestamp,W.LongWithoutOverridesClass;var G=r(function(e,t){function n(e){return U.isObjectLike(e)&&Reflect.has(e,"_bsontype")&&"string"==typeof e._bsontype}Object.defineProperty(t,"__esModule",{value:!0}),t.EJSON=t.isBSONType=void 0,t.isBSONType=n;const r=2147483647,i=-2147483648,o=0x8000000000000000,s=-0x8000000000000000,u={$oid:k.ObjectId,$binary:x.Binary,$uuid:x.Binary,$symbol:V.BSONSymbol,$numberInt:J.Int32,$numberDecimal:C.Decimal128,$numberDouble:z.Double,$numberLong:$.Long,$minKey:K.MinKey,$maxKey:F.MaxKey,$regex:X.BSONRegExp,$regularExpression:X.BSONRegExp,$timestamp:W.Timestamp};function f(e){const t=e.toISOString();return 0!==e.getUTCMilliseconds()?t:t.slice(0,-5)+"Z"}function l(e,t){if(Array.isArray(e))return function(e,t){return e.map(e=>l(e,t))}(e,t);if(void 0===e)return null;if(e instanceof Date){const n=e.getTime(),r=n>-1&&n<2534023188e5;return t.legacy?t.relaxed&&r?{$date:e.getTime()}:{$date:f(e)}:t.relaxed&&r?{$date:f(e)}:{$date:{$numberLong:e.getTime().toString()}}}if("number"==typeof e&&!t.relaxed){if(Math.floor(e)===e){const t=e>=s&&e<=o;if(e>=i&&e<=r)return{$numberInt:e.toString()};if(t)return{$numberLong:e.toString()}}return{$numberDouble:e.toString()}}if(e instanceof RegExp){let n=e.flags;if(void 0===n){const t=e.toString().match(/[gimuy]*$/);t&&(n=t[0])}return new X.BSONRegExp(e.source,n).toExtendedJSON(t)}return null!=e&&"object"==typeof e?function(e,t){if(null==e||"object"!=typeof e)throw new Error("not an object instance");const r=e._bsontype;if(void 0===r){const n={};for(const r in e)n[r]=l(e[r],t);return n}if(n(e)){let n=e;if("function"!=typeof n.toExtendedJSON){const t=a[e._bsontype];if(!t)throw new TypeError("Unrecognized or invalid _bsontype: "+e._bsontype);n=t(n)}return"Code"===r&&n.scope?n=new P.Code(n.code,l(n.scope,t)):"DBRef"===r&&n.oid&&(n=new Y.DBRef(n.collection,l(n.oid,t),n.db,n.fields)),n.toExtendedJSON(t)}throw new Error("_bsontype must be a string, but was: "+typeof r)}(e,t):e}const a={Binary:e=>new x.Binary(e.value(),e.sub_type),Code:e=>new P.Code(e.code,e.scope),DBRef:e=>new Y.DBRef(e.collection||e.namespace,e.oid,e.db,e.fields),Decimal128:e=>new C.Decimal128(e.bytes),Double:e=>new z.Double(e.value),Int32:e=>new J.Int32(e.value),Long:e=>$.Long.fromBits(null!=e.low?e.low:e.low_,null!=e.low?e.high:e.high_,null!=e.low?e.unsigned:e.unsigned_),MaxKey:()=>new F.MaxKey,MinKey:()=>new K.MinKey,ObjectID:e=>new k.ObjectId(e),ObjectId:e=>new k.ObjectId(e),BSONRegExp:e=>new X.BSONRegExp(e.pattern,e.options),Symbol:e=>new V.BSONSymbol(e.value),Timestamp:e=>W.Timestamp.fromBits(e.low,e.high)};(function(e){function t(e,t){const n=Object.assign({},{relaxed:!0,legacy:!1},t);return"boolean"==typeof n.relaxed&&(n.strict=!n.relaxed),"boolean"==typeof n.strict&&(n.relaxed=!n.strict),JSON.parse(e,(e,t)=>(function e(t,n={}){if("number"==typeof t){if(n.relaxed||n.legacy)return t;if(Math.floor(t)===t){if(t>=i&&t<=r)return new J.Int32(t);if(t>=s&&t<=o)return $.Long.fromNumber(t)}return new z.Double(t)}if(null==t||"object"!=typeof t)return t;if(t.$undefined)return null;const f=Object.keys(t).filter(e=>e.startsWith("$")&&null!=t[e]);for(let e=0;e<f.length;e++){const r=u[f[e]];if(r)return r.fromExtendedJSON(t,n)}if(null!=t.$date){const e=t.$date,r=new Date;return n.legacy?"number"==typeof e?r.setTime(e):"string"==typeof e&&r.setTime(Date.parse(e)):"string"==typeof e?r.setTime(Date.parse(e)):$.Long.isLong(e)?r.setTime(e.toNumber()):"number"==typeof e&&n.relaxed&&r.setTime(e),r}if(null!=t.$code){const n=Object.assign({},t);return t.$scope&&(n.$scope=e(t.$scope)),P.Code.fromExtendedJSON(t)}if(null!=t.$ref||null!=t.$dbPointer){const e=t.$ref?t:t.$dbPointer;if(e instanceof Y.DBRef)return e;let n=!0;if(Object.keys(e).filter(e=>e.startsWith("$")).forEach(e=>{-1===["$ref","$id","$db"].indexOf(e)&&(n=!1)}),n)return Y.DBRef.fromExtendedJSON(e)}return t})(t,n))}function n(e,t,n,r){null!=n&&"object"==typeof n&&(r=n,n=0),null==t||"object"!=typeof t||Array.isArray(t)||(r=t,t=void 0,n=0);const i=l(e,r=Object.assign({},{relaxed:!0,legacy:!1},r));return JSON.stringify(i,t,n)}e.parse=t,e.stringify=n,e.serialize=function(e,t){return t=t||{},JSON.parse(n(e,t))},e.deserialize=function(e,n){return n=n||{},t(JSON.stringify(e),n)}})(t.EJSON||(t.EJSON={}))});n(G);G.EJSON,G.isBSONType;var H=r(function(e,n){let r;Object.defineProperty(n,"__esModule",{value:!0}),n.Map=void 0,n.Map=r;const i=function(e){return e&&e.Math==Math&&e};const o=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof t&&t)||Function("return this")();Object.prototype.hasOwnProperty.call(o,"Map")?n.Map=r=o.Map:n.Map=r=class{constructor(e=[]){this._keys=[],this._values={};for(let t=0;t<e.length;t++){if(null==e[t])continue;const n=e[t],r=n[0],i=n[1];this._keys.push(r),this._values[r]={v:i,i:this._keys.length-1}}}clear(){this._keys=[],this._values={}}delete(e){const t=this._values[e];return null!=t&&(delete this._values[e],this._keys.splice(t.i,1),!0)}entries(){let e=0;return{next:()=>{const t=this._keys[e++];return{value:void 0!==t?[t,this._values[t].v]:void 0,done:void 0===t}}}}forEach(e,t){t=t||this;for(let n=0;n<this._keys.length;n++){const r=this._keys[n];e.call(t,this._values[r].v,r,t)}}get(e){return this._values[e]?this._values[e].v:void 0}has(e){return null!=this._values[e]}keys(){let e=0;return{next:()=>{const t=this._keys[e++];return{value:void 0!==t?t:void 0,done:void 0===t}}}}set(e,t){return this._values[e]?(this._values[e].v=t,this):(this._keys.push(e),this._values[e]={v:t,i:this._keys.length-1},this)}values(){let e=0;return{next:()=>{const t=this._keys[e++];return{value:void 0!==t?this._values[t].v:void 0,done:void 0===t}}}}get size(){return this._keys.length}}});n(H);H.Map;var q=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.BSON_BINARY_SUBTYPE_USER_DEFINED=t.BSON_BINARY_SUBTYPE_MD5=t.BSON_BINARY_SUBTYPE_UUID_NEW=t.BSON_BINARY_SUBTYPE_UUID=t.BSON_BINARY_SUBTYPE_BYTE_ARRAY=t.BSON_BINARY_SUBTYPE_FUNCTION=t.BSON_BINARY_SUBTYPE_DEFAULT=t.BSON_DATA_MAX_KEY=t.BSON_DATA_MIN_KEY=t.BSON_DATA_DECIMAL128=t.BSON_DATA_LONG=t.BSON_DATA_TIMESTAMP=t.BSON_DATA_INT=t.BSON_DATA_CODE_W_SCOPE=t.BSON_DATA_SYMBOL=t.BSON_DATA_CODE=t.BSON_DATA_DBPOINTER=t.BSON_DATA_REGEXP=t.BSON_DATA_NULL=t.BSON_DATA_DATE=t.BSON_DATA_BOOLEAN=t.BSON_DATA_OID=t.BSON_DATA_UNDEFINED=t.BSON_DATA_BINARY=t.BSON_DATA_ARRAY=t.BSON_DATA_OBJECT=t.BSON_DATA_STRING=t.BSON_DATA_NUMBER=t.JS_INT_MIN=t.JS_INT_MAX=t.BSON_INT64_MIN=t.BSON_INT64_MAX=t.BSON_INT32_MIN=t.BSON_INT32_MAX=void 0,t.BSON_INT32_MAX=2147483647,t.BSON_INT32_MIN=-2147483648,t.BSON_INT64_MAX=Math.pow(2,63)-1,t.BSON_INT64_MIN=-Math.pow(2,63),t.JS_INT_MAX=Math.pow(2,53),t.JS_INT_MIN=-Math.pow(2,53),t.BSON_DATA_NUMBER=1,t.BSON_DATA_STRING=2,t.BSON_DATA_OBJECT=3,t.BSON_DATA_ARRAY=4,t.BSON_DATA_BINARY=5,t.BSON_DATA_UNDEFINED=6,t.BSON_DATA_OID=7,t.BSON_DATA_BOOLEAN=8,t.BSON_DATA_DATE=9,t.BSON_DATA_NULL=10,t.BSON_DATA_REGEXP=11,t.BSON_DATA_DBPOINTER=12,t.BSON_DATA_CODE=13,t.BSON_DATA_SYMBOL=14,t.BSON_DATA_CODE_W_SCOPE=15,t.BSON_DATA_INT=16,t.BSON_DATA_TIMESTAMP=17,t.BSON_DATA_LONG=18,t.BSON_DATA_DECIMAL128=19,t.BSON_DATA_MIN_KEY=255,t.BSON_DATA_MAX_KEY=127,t.BSON_BINARY_SUBTYPE_DEFAULT=0,t.BSON_BINARY_SUBTYPE_FUNCTION=1,t.BSON_BINARY_SUBTYPE_BYTE_ARRAY=2,t.BSON_BINARY_SUBTYPE_UUID=3,t.BSON_BINARY_SUBTYPE_UUID_NEW=4,t.BSON_BINARY_SUBTYPE_MD5=5,t.BSON_BINARY_SUBTYPE_USER_DEFINED=128});n(q);q.BSON_BINARY_SUBTYPE_USER_DEFINED,q.BSON_BINARY_SUBTYPE_MD5,q.BSON_BINARY_SUBTYPE_UUID_NEW,q.BSON_BINARY_SUBTYPE_UUID,q.BSON_BINARY_SUBTYPE_BYTE_ARRAY,q.BSON_BINARY_SUBTYPE_FUNCTION,q.BSON_BINARY_SUBTYPE_DEFAULT,q.BSON_DATA_MAX_KEY,q.BSON_DATA_MIN_KEY,q.BSON_DATA_DECIMAL128,q.BSON_DATA_LONG,q.BSON_DATA_TIMESTAMP,q.BSON_DATA_INT,q.BSON_DATA_CODE_W_SCOPE,q.BSON_DATA_SYMBOL,q.BSON_DATA_CODE,q.BSON_DATA_DBPOINTER,q.BSON_DATA_REGEXP,q.BSON_DATA_NULL,q.BSON_DATA_DATE,q.BSON_DATA_BOOLEAN,q.BSON_DATA_OID,q.BSON_DATA_UNDEFINED,q.BSON_DATA_BINARY,q.BSON_DATA_ARRAY,q.BSON_DATA_OBJECT,q.BSON_DATA_STRING,q.BSON_DATA_NUMBER,q.JS_INT_MIN,q.JS_INT_MAX,q.BSON_INT64_MIN,q.BSON_INT64_MAX,q.BSON_INT32_MIN,q.BSON_INT32_MAX;var Z=r(function(t,n){function r(e,t,n){let r=5;if(Array.isArray(e))for(let o=0;o<e.length;o++)r+=i(o.toString(),e[o],t,!0,n);else{e.toBSON&&(e=e.toBSON());for(const o in e)r+=i(o,e[o],t,!1,n)}return r}function i(t,n,i=!1,o=!1,s=!1){switch(n&&n.toBSON&&(n=n.toBSON()),typeof n){case"string":return 1+e.Buffer.byteLength(t,"utf8")+1+4+e.Buffer.byteLength(n,"utf8")+1;case"number":return Math.floor(n)===n&&n>=q.JS_INT_MIN&&n<=q.JS_INT_MAX&&n>=q.BSON_INT32_MIN&&n<=q.BSON_INT32_MAX?(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+5:(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+9;case"undefined":return o||!s?(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+1:0;case"boolean":return(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+2;case"object":if(null==n||"MinKey"===n._bsontype||"MaxKey"===n._bsontype)return(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+1;if("ObjectId"===n._bsontype||"ObjectID"===n._bsontype)return(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+13;if(n instanceof Date||U.isDate(n))return(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+9;if(ArrayBuffer.isView(n)||n instanceof ArrayBuffer)return(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+6+n.byteLength;if("Long"===n._bsontype||"Double"===n._bsontype||"Timestamp"===n._bsontype)return(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+9;if("Decimal128"===n._bsontype)return(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+17;if("Code"===n._bsontype)return null!=n.scope&&Object.keys(n.scope).length>0?(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+1+4+4+e.Buffer.byteLength(n.code.toString(),"utf8")+1+r(n.scope,i,s):(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+1+4+e.Buffer.byteLength(n.code.toString(),"utf8")+1;if("Binary"===n._bsontype)return n.sub_type===x.Binary.SUBTYPE_BYTE_ARRAY?(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+(n.position+1+4+1+4):(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+(n.position+1+4+1);if("Symbol"===n._bsontype)return(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+e.Buffer.byteLength(n.value,"utf8")+4+1+1;if("DBRef"===n._bsontype){const o=Object.assign({$ref:n.collection,$id:n.oid},n.fields);return null!=n.db&&(o.$db=n.db),(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+1+r(o,i,s)}return n instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(n)?(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+1+e.Buffer.byteLength(n.source,"utf8")+1+(n.global?1:0)+(n.ignoreCase?1:0)+(n.multiline?1:0)+1:"BSONRegExp"===n._bsontype?(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+1+e.Buffer.byteLength(n.pattern,"utf8")+1+e.Buffer.byteLength(n.options,"utf8")+1:(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+r(n,i,s)+1;case"function":if(n instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(n)||"[object RegExp]"===String.call(n))return(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+1+e.Buffer.byteLength(n.source,"utf8")+1+(n.global?1:0)+(n.ignoreCase?1:0)+(n.multiline?1:0)+1;if(i&&null!=n.scope&&Object.keys(n.scope).length>0)return(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+1+4+4+e.Buffer.byteLength(U.normalizedFunctionString(n),"utf8")+1+r(n.scope,i,s);if(i)return(null!=t?e.Buffer.byteLength(t,"utf8")+1:0)+1+4+e.Buffer.byteLength(U.normalizedFunctionString(n),"utf8")+1}return 0}Object.defineProperty(n,"__esModule",{value:!0}),n.calculateObjectSize=void 0,n.calculateObjectSize=r});n(Z);Z.calculateObjectSize;var Q=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.validateUtf8=void 0;const n=128,r=192,i=224,o=240,s=248,u=192,f=224,l=240,a=128;t.validateUtf8=function(e,t,c){let h=0;for(let _=t;_<c;_+=1){const t=e[_];if(h){if((t&r)!==a)return!1;h-=1}else if(t&n)if((t&i)===u)h=1;else if((t&o)===f)h=2;else{if((t&s)!==l)return!1;h=3}}return!h}});n(Q);Q.validateUtf8;var ee=r(function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.deserialize=void 0;const r=$.Long.fromNumber(q.JS_INT_MAX),i=$.Long.fromNumber(q.JS_INT_MIN),o={};function s(t,n,f,l=!1){const a=null!=f.evalFunctions&&f.evalFunctions,c=null!=f.cacheFunctions&&f.cacheFunctions,h=null==f.fieldsAsRaw?null:f.fieldsAsRaw,_=null!=f.raw&&f.raw,g="boolean"==typeof f.bsonRegExp&&f.bsonRegExp,d=null!=f.promoteBuffers&&f.promoteBuffers,p=null==f.promoteLongs||f.promoteLongs,B=null==f.promoteValues||f.promoteValues,N=n;if(t.length<5)throw new Error("corrupt bson message < 5 bytes long");const O=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;if(O<5||O>t.length)throw new Error("corrupt bson message");const b=l?[]:{};let y=0;for(;;){const N=t[n++];if(0===N)break;let O=n;for(;0!==t[O]&&O<t.length;)O++;if(O>=t.byteLength)throw new Error("Bad BSON Document: illegal CString");const S=l?y++:t.toString("utf8",n,O);if(n=O+1,N===q.BSON_DATA_STRING){const e=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;if(e<=0||e>t.length-n||0!==t[n+e-1])throw new Error("bad string length in bson");if(!Q.validateUtf8(t,n,n+e-1))throw new Error("Invalid UTF-8 string in BSON document");const r=t.toString("utf8",n,n+e-1);b[S]=r,n+=e}else if(N===q.BSON_DATA_OID){const r=e.Buffer.alloc(12);t.copy(r,0,n,n+12),b[S]=new k.ObjectId(r),n+=12}else if(N===q.BSON_DATA_INT&&!1===B)b[S]=new J.Int32(t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24);else if(N===q.BSON_DATA_INT)b[S]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;else if(N===q.BSON_DATA_NUMBER&&!1===B)b[S]=new z.Double(t.readDoubleLE(n)),n+=8;else if(N===q.BSON_DATA_NUMBER)b[S]=t.readDoubleLE(n),n+=8;else if(N===q.BSON_DATA_DATE){const e=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24,r=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;b[S]=new Date(new $.Long(e,r).toNumber())}else if(N===q.BSON_DATA_BOOLEAN){if(0!==t[n]&&1!==t[n])throw new Error("illegal boolean type value");b[S]=1===t[n++]}else if(N===q.BSON_DATA_OBJECT){const e=n,r=t[n]|t[n+1]<<8|t[n+2]<<16|t[n+3]<<24;if(r<=0||r>t.length-n)throw new Error("bad embedded document length in bson");b[S]=_?t.slice(n,n+r):s(t,e,f,!1),n+=r}else if(N===q.BSON_DATA_ARRAY){const e=n,r=t[n]|t[n+1]<<8|t[n+2]<<16|t[n+3]<<24;let i=f;const o=n+r;if(h&&h[S]){i={};for(const e in f)i[e]=f[e];i.raw=!0}if(b[S]=s(t,e,i,!0),0!==t[(n+=r)-1])throw new Error("invalid array terminator byte");if(n!==o)throw new Error("corrupted array bson")}else if(N===q.BSON_DATA_UNDEFINED)b[S]=void 0;else if(N===q.BSON_DATA_NULL)b[S]=null;else if(N===q.BSON_DATA_LONG){const e=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24,o=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24,s=new $.Long(e,o);b[S]=p&&!0===B&&s.lessThanOrEqual(r)&&s.greaterThanOrEqual(i)?s.toNumber():s}else if(N===q.BSON_DATA_DECIMAL128){const r=e.Buffer.alloc(16);t.copy(r,0,n,n+16),n+=16;const i=new C.Decimal128(r);"toObject"in i&&"function"==typeof i.toObject?b[S]=i.toObject():b[S]=i}else if(N===q.BSON_DATA_BINARY){let r=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;const i=r,o=t[n++];if(r<0)throw new Error("Negative binary type element size found");if(r>t.byteLength)throw new Error("Binary type size larger than document size");if(null!=t.slice){if(o===x.Binary.SUBTYPE_BYTE_ARRAY){if((r=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24)<0)throw new Error("Negative binary type element size found for subtype 0x02");if(r>i-4)throw new Error("Binary type with subtype 0x02 contains too long binary size");if(r<i-4)throw new Error("Binary type with subtype 0x02 contains too short binary size")}b[S]=d&&B?t.slice(n,n+r):new x.Binary(t.slice(n,n+r),o)}else{const s=e.Buffer.alloc(r);if(o===x.Binary.SUBTYPE_BYTE_ARRAY){if((r=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24)<0)throw new Error("Negative binary type element size found for subtype 0x02");if(r>i-4)throw new Error("Binary type with subtype 0x02 contains too long binary size");if(r<i-4)throw new Error("Binary type with subtype 0x02 contains too short binary size")}for(O=0;O<r;O++)s[O]=t[n+O];b[S]=d&&B?s:new x.Binary(s,o)}n+=r}else if(N===q.BSON_DATA_REGEXP&&!1===g){for(O=n;0!==t[O]&&O<t.length;)O++;if(O>=t.length)throw new Error("Bad BSON Document: illegal CString");const e=t.toString("utf8",n,O);for(O=n=O+1;0!==t[O]&&O<t.length;)O++;if(O>=t.length)throw new Error("Bad BSON Document: illegal CString");const r=t.toString("utf8",n,O);n=O+1;const i=new Array(r.length);for(O=0;O<r.length;O++)switch(r[O]){case"m":i[O]="m";break;case"s":i[O]="g";break;case"i":i[O]="i"}b[S]=new RegExp(e,i.join(""))}else if(N===q.BSON_DATA_REGEXP&&!0===g){for(O=n;0!==t[O]&&O<t.length;)O++;if(O>=t.length)throw new Error("Bad BSON Document: illegal CString");const e=t.toString("utf8",n,O);for(O=n=O+1;0!==t[O]&&O<t.length;)O++;if(O>=t.length)throw new Error("Bad BSON Document: illegal CString");const r=t.toString("utf8",n,O);n=O+1,b[S]=new X.BSONRegExp(e,r)}else if(N===q.BSON_DATA_SYMBOL){const e=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;if(e<=0||e>t.length-n||0!==t[n+e-1])throw new Error("bad string length in bson");const r=t.toString("utf8",n,n+e-1);b[S]=B?r:new V.BSONSymbol(r),n+=e}else if(N===q.BSON_DATA_TIMESTAMP){const e=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24,r=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;b[S]=new W.Timestamp(e,r)}else if(N===q.BSON_DATA_MIN_KEY)b[S]=new K.MinKey;else if(N===q.BSON_DATA_MAX_KEY)b[S]=new F.MaxKey;else if(N===q.BSON_DATA_CODE){const e=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;if(e<=0||e>t.length-n||0!==t[n+e-1])throw new Error("bad string length in bson");const r=t.toString("utf8",n,n+e-1);b[S]=a?c?u(r,o,b):u(r):new P.Code(r),n+=e}else if(N===q.BSON_DATA_CODE_W_SCOPE){const e=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;if(e<13)throw new Error("code_w_scope total size shorter minimum expected length");const r=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;if(r<=0||r>t.length-n||0!==t[n+r-1])throw new Error("bad string length in bson");const i=t.toString("utf8",n,n+r-1),l=n+=r,h=t[n]|t[n+1]<<8|t[n+2]<<16|t[n+3]<<24,_=s(t,l,f,!1);if(n+=h,e<8+h+r)throw new Error("code_w_scope total size is too short, truncating scope");if(e>8+h+r)throw new Error("code_w_scope total size is too long, clips outer document");a?(b[S]=c?u(i,o,b):u(i),b[S].scope=_):b[S]=new P.Code(i,_)}else{if(N!==q.BSON_DATA_DBPOINTER)throw new Error("Detected unknown BSON type "+N.toString(16)+' for fieldname "'+S+'"');{const r=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;if(r<=0||r>t.length-n||0!==t[n+r-1])throw new Error("bad string length in bson");if(!Q.validateUtf8(t,n,n+r-1))throw new Error("Invalid UTF-8 string in BSON document");const i=t.toString("utf8",n,n+r-1);n+=r;const o=e.Buffer.alloc(12);t.copy(o,0,n,n+12);const s=new k.ObjectId(o);n+=12,b[S]=new Y.DBRef(i,s)}}}if(O!==n-N){if(l)throw new Error("corrupt array bson");throw new Error("corrupt object bson")}let S=!0;if(Object.keys(b).filter(e=>e.startsWith("$")).forEach(e=>{-1===["$ref","$id","$db"].indexOf(e)&&(S=!1)}),!S)return b;if(Y.isDBRefLike(b)){const e=Object.assign({},b);return delete e.$ref,delete e.$id,delete e.$db,new Y.DBRef(b.$ref,b.$id,b.$db,e)}return b}function u(e,t,n){return t?(null==t[e]&&(t[e]=new Function(e)),t[e].bind(n)):new Function(e)}n.deserialize=function(e,t,n){const r=(t=null==t?{}:t)&&t.index?t.index:0,i=e[r]|e[r+1]<<8|e[r+2]<<16|e[r+3]<<24;if(i<5)throw new Error(`bson size must be >= 5, is ${i}`);if(t.allowObjectSmallerThanBufferSize&&e.length<i)throw new Error(`buffer length ${e.length} must be >= bson size ${i}`);if(!t.allowObjectSmallerThanBufferSize&&e.length!==i)throw new Error(`buffer length ${e.length} must === bson size ${i}`);if(i+r>e.byteLength)throw new Error(`(bson size ${i} + options.index ${r} must be <= buffer length ${e.byteLength})`);if(0!==e[r+i-1])throw new Error("One object, sized correctly, with a spot for an EOO, but the EOO isn't 0x00");return s(e,r,t,n)}});n(ee);ee.deserialize;var te=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.writeIEEE754=t.readIEEE754=void 0,t.readIEEE754=function(e,t,n,r,i){let o,s;const u="big"===n,f=8*i-r-1,l=(1<<f)-1,a=l>>1;let c=-7,h=u?0:i-1;const _=u?1:-1;let g=e[t+h];for(h+=_,o=g&(1<<-c)-1,g>>=-c,c+=f;c>0;o=256*o+e[t+h],h+=_,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=r;c>0;s=256*s+e[t+h],h+=_,c-=8);if(0===o)o=1-a;else{if(o===l)return s?NaN:1/0*(g?-1:1);s+=Math.pow(2,r),o-=a}return(g?-1:1)*s*Math.pow(2,o-r)},t.writeIEEE754=function(e,t,n,r,i,o){let s,u,f;const l="big"===r;let a=8*o-i-1;const c=(1<<a)-1,h=c>>1,_=23===i?Math.pow(2,-24)-Math.pow(2,-77):0;let g=l?o-1:0;const d=l?-1:1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(f=Math.pow(2,-s))<1&&(s--,f*=2),(t+=s+h>=1?_/f:_*Math.pow(2,1-h))*f>=2&&(s++,f/=2),s+h>=c?(u=0,s=c):s+h>=1?(u=(t*f-1)*Math.pow(2,i),s+=h):(u=t*Math.pow(2,h-1)*Math.pow(2,i),s=0)),isNaN(t)&&(u=0);i>=8;)e[n+g]=255&u,g+=d,u/=256,i-=8;for(s=s<<i|u,isNaN(t)&&(s+=8),a+=i;a>0;)e[n+g]=255&s,g+=d,s/=256,a-=8;e[n+g-d]|=128*p}});n(te);te.writeIEEE754,te.readIEEE754;var ne=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.serializeInto=void 0;const n=/\x00/,r=new Set(["$db","$ref","$id","$clusterTime"]);function i(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function o(e,t,n,r,i){e[r++]=q.BSON_DATA_STRING,e[(r=r+(i?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"))+1)-1]=0;const o=e.write(n,r+4,void 0,"utf8");return e[r+3]=o+1>>24&255,e[r+2]=o+1>>16&255,e[r+1]=o+1>>8&255,e[r]=o+1&255,r=r+4+o,e[r++]=0,r}function s(e,t,n,r,i){if(Number.isInteger(n)&&n>=q.BSON_INT32_MIN&&n<=q.BSON_INT32_MAX){e[r++]=q.BSON_DATA_INT,r+=i?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0,e[r++]=255&n,e[r++]=n>>8&255,e[r++]=n>>16&255,e[r++]=n>>24&255}else{e[r++]=q.BSON_DATA_NUMBER,r+=i?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0,te.writeIEEE754(e,n,r,"little",52,8),r+=8}return r}function u(e,t,n,r,i){return e[r++]=q.BSON_DATA_NULL,r+=i?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0,r}function f(e,t,n,r,i){return e[r++]=q.BSON_DATA_BOOLEAN,r+=i?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0,e[r++]=n?1:0,r}function l(e,t,n,r,i){e[r++]=q.BSON_DATA_DATE,r+=i?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0;const o=$.Long.fromNumber(n.getTime()),s=o.getLowBits(),u=o.getHighBits();return e[r++]=255&s,e[r++]=s>>8&255,e[r++]=s>>16&255,e[r++]=s>>24&255,e[r++]=255&u,e[r++]=u>>8&255,e[r++]=u>>16&255,e[r++]=u>>24&255,r}function a(e,t,r,i,o){if(e[i++]=q.BSON_DATA_REGEXP,i+=o?e.write(t,i,void 0,"ascii"):e.write(t,i,void 0,"utf8"),e[i++]=0,r.source&&null!=r.source.match(n))throw Error("value "+r.source+" must not contain null bytes");return i+=e.write(r.source,i,void 0,"utf8"),e[i++]=0,r.ignoreCase&&(e[i++]=105),r.global&&(e[i++]=115),r.multiline&&(e[i++]=109),e[i++]=0,i}function c(e,t,r,i,o){if(e[i++]=q.BSON_DATA_REGEXP,i+=o?e.write(t,i,void 0,"ascii"):e.write(t,i,void 0,"utf8"),e[i++]=0,null!=r.pattern.match(n))throw Error("pattern "+r.pattern+" must not contain null bytes");return i+=e.write(r.pattern,i,void 0,"utf8"),e[i++]=0,i+=e.write(r.options.split("").sort().join(""),i,void 0,"utf8"),e[i++]=0,i}function h(e,t,n,r,i){return null===n?e[r++]=q.BSON_DATA_NULL:"MinKey"===n._bsontype?e[r++]=q.BSON_DATA_MIN_KEY:e[r++]=q.BSON_DATA_MAX_KEY,r+=i?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0,r}function _(e,t,n,r,i){if(e[r++]=q.BSON_DATA_OID,r+=i?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0,"string"==typeof n.id)e.write(n.id,r,void 0,"binary");else{if(!n.id||!n.id.copy)throw new TypeError("object ["+JSON.stringify(n)+"] is not a valid ObjectId");n.id.copy(e,r,0,12)}return r+12}function g(e,t,n,r,i){e[r++]=q.BSON_DATA_BINARY,r+=i?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0;const o=n.length;return e[r++]=255&o,e[r++]=o>>8&255,e[r++]=o>>16&255,e[r++]=o>>24&255,e[r++]=q.BSON_BINARY_SUBTYPE_DEFAULT,e.set(M.ensureBuffer(n),r),r+=o}function d(e,t,n,r,i=!1,o=0,s=!1,u=!0,f=!1,l=[]){for(let e=0;e<l.length;e++)if(l[e]===n)throw new Error("cyclic dependency detected");l.push(n),e[r++]=Array.isArray(n)?q.BSON_DATA_ARRAY:q.BSON_DATA_OBJECT,r+=f?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0;const a=E(e,n,i,r,o+1,s,u,l);return l.pop(),a}function p(e,t,n,r,i){return e[r++]=q.BSON_DATA_DECIMAL128,r+=i?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0,n.bytes.copy(e,r,0,16),r+16}function B(e,t,n,r,i){e[r++]="Long"===n._bsontype?q.BSON_DATA_LONG:q.BSON_DATA_TIMESTAMP,r+=i?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0;const o=n.getLowBits(),s=n.getHighBits();return e[r++]=255&o,e[r++]=o>>8&255,e[r++]=o>>16&255,e[r++]=o>>24&255,e[r++]=255&s,e[r++]=s>>8&255,e[r++]=s>>16&255,e[r++]=s>>24&255,r}function N(e,t,n,r,i){return n=n.valueOf(),e[r++]=q.BSON_DATA_INT,r+=i?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0,e[r++]=255&n,e[r++]=n>>8&255,e[r++]=n>>16&255,e[r++]=n>>24&255,r}function O(e,t,n,r,i){return e[r++]=q.BSON_DATA_NUMBER,r+=i?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0,te.writeIEEE754(e,n.value,r,"little",52,8),r+=8}function b(e,t,n,r,i=!1,o=0,s){e[r++]=q.BSON_DATA_CODE,r+=s?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0;const u=U.normalizedFunctionString(n),f=e.write(u,r+4,void 0,"utf8")+1;return e[r]=255&f,e[r+1]=f>>8&255,e[r+2]=f>>16&255,e[r+3]=f>>24&255,r=r+4+f-1,e[r++]=0,r}function y(e,t,n,r,i=!1,o=0,s=!1,u=!0,f=!1){if(n.scope&&"object"==typeof n.scope){e[r++]=q.BSON_DATA_CODE_W_SCOPE,r+=f?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0;let l=r;const a="string"==typeof n.code?n.code:n.code.toString();r+=4;const c=e.write(a,r+4,void 0,"utf8")+1;e[r]=255&c,e[r+1]=c>>8&255,e[r+2]=c>>16&255,e[r+3]=c>>24&255,e[r+4+c-1]=0,r=r+c+4;const h=E(e,n.scope,i,r,o+1,s,u);r=h-1;const _=h-l;e[l++]=255&_,e[l++]=_>>8&255,e[l++]=_>>16&255,e[l++]=_>>24&255,e[r++]=0}else{e[r++]=q.BSON_DATA_CODE,r+=f?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0;const i=n.code.toString(),o=e.write(i,r+4,void 0,"utf8")+1;e[r]=255&o,e[r+1]=o>>8&255,e[r+2]=o>>16&255,e[r+3]=o>>24&255,r=r+4+o-1,e[r++]=0}return r}function S(e,t,n,r,i){e[r++]=q.BSON_DATA_BINARY,r+=i?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0;const o=n.value(!0);let s=n.position;return n.sub_type===x.Binary.SUBTYPE_BYTE_ARRAY&&(s+=4),e[r++]=255&s,e[r++]=s>>8&255,e[r++]=s>>16&255,e[r++]=s>>24&255,e[r++]=n.sub_type,n.sub_type===x.Binary.SUBTYPE_BYTE_ARRAY&&(s-=4,e[r++]=255&s,e[r++]=s>>8&255,e[r++]=s>>16&255,e[r++]=s>>24&255),e.set(o,r),r+=n.position}function A(e,t,n,r,i){e[r++]=q.BSON_DATA_SYMBOL,r+=i?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0;const o=e.write(n.value,r+4,void 0,"utf8")+1;return e[r]=255&o,e[r+1]=o>>8&255,e[r+2]=o>>16&255,e[r+3]=o>>24&255,r=r+4+o-1,e[r++]=0,r}function m(e,t,n,r,i,o,s){e[r++]=q.BSON_DATA_OBJECT,r+=s?e.write(t,r,void 0,"ascii"):e.write(t,r,void 0,"utf8"),e[r++]=0;let u=r,f={$ref:n.collection||n.namespace,$id:n.oid};null!=n.db&&(f.$db=n.db);const l=E(e,f=Object.assign(f,n.fields),!1,r,i+1,o),a=l-u;return e[u++]=255&a,e[u++]=a>>8&255,e[u++]=a>>16&255,e[u++]=a>>24&255,l}function E(e,t,E=!1,T=0,D=0,w=!1,I=!0,v=[]){T=T||0,(v=v||[]).push(t);let R=T+4;if(Array.isArray(t))for(let n=0;n<t.length;n++){const r=""+n;let T=t[n];if(T&&T.toBSON){if("function"!=typeof T.toBSON)throw new TypeError("toBSON is not a function");T=T.toBSON()}if("string"==typeof T)R=o(e,r,T,R,!0);else if("number"==typeof T)R=s(e,r,T,R,!0);else{if("bigint"==typeof T)throw new TypeError("Unsupported type BigInt, please use Decimal128");if("boolean"==typeof T)R=f(e,r,T,R,!0);else if(T instanceof Date||U.isDate(T))R=l(e,r,T,R,!0);else if(void 0===T)R=u(e,r,0,R,!0);else if(null===T)R=u(e,r,0,R,!0);else if("ObjectId"===T._bsontype||"ObjectID"===T._bsontype)R=_(e,r,T,R,!0);else if(U.isBuffer(T)||U.isUint8Array(T))R=g(e,r,T,R,!0);else if(T instanceof RegExp||i(T))R=a(e,r,T,R,!0);else if("object"==typeof T&&null==T._bsontype)R=d(e,r,T,R,E,D,w,I,!0,v);else if("object"==typeof T&&G.isBSONType(T)&&"Decimal128"===T._bsontype)R=p(e,r,T,R,!0);else if("Long"===T._bsontype||"Timestamp"===T._bsontype)R=B(e,r,T,R,!0);else if("Double"===T._bsontype)R=O(e,r,T,R,!0);else if("function"==typeof T&&w)R=b(e,r,T,R,E,D,!0);else if("Code"===T._bsontype)R=y(e,r,T,R,E,D,w,I,!0);else if("Binary"===T._bsontype)R=S(e,r,T,R,!0);else if("Symbol"===T._bsontype)R=A(e,r,T,R,!0);else if("DBRef"===T._bsontype)R=m(e,r,T,R,D,w,!0);else if("BSONRegExp"===T._bsontype)R=c(e,r,T,R,!0);else if("Int32"===T._bsontype)R=N(e,r,T,R,!0);else if("MinKey"===T._bsontype||"MaxKey"===T._bsontype)R=h(e,r,T,R,!0);else if(void 0!==T._bsontype)throw new TypeError("Unrecognized or invalid _bsontype: "+T._bsontype)}}else if(t instanceof H.Map){const T=t.entries();let L=!1;for(;!L;){const t=T.next();if(L=!!t.done)continue;const M=t.value[0],j=t.value[1],x=typeof j;if("string"==typeof M&&!r.has(M)){if(null!=M.match(n))throw Error("key "+M+" must not contain null bytes");if(E){if("$"===M[0])throw Error("key "+M+" must not start with '$'");if(~M.indexOf("."))throw Error("key "+M+" must not contain '.'")}}if("string"===x)R=o(e,M,j,R);else if("number"===x)R=s(e,M,j,R);else{if("bigint"===x||U.isBigInt64Array(j)||U.isBigUInt64Array(j))throw new TypeError("Unsupported type BigInt, please use Decimal128");if("boolean"===x)R=f(e,M,j,R);else if(j instanceof Date||U.isDate(j))R=l(e,M,j,R);else if(null===j||void 0===j&&!1===I)R=u(e,M,0,R);else if("ObjectId"===j._bsontype||"ObjectID"===j._bsontype)R=_(e,M,j,R);else if(U.isBuffer(j)||U.isUint8Array(j))R=g(e,M,j,R);else if(j instanceof RegExp||i(j))R=a(e,M,j,R);else if("object"===x&&null==j._bsontype)R=d(e,M,j,R,E,D,w,I,!1,v);else if("object"===x&&"Decimal128"===j._bsontype)R=p(e,M,j,R);else if("Long"===j._bsontype||"Timestamp"===j._bsontype)R=B(e,M,j,R);else if("Double"===j._bsontype)R=O(e,M,j,R);else if("Code"===j._bsontype)R=y(e,M,j,R,E,D,w,I);else if("function"==typeof j&&w)R=b(e,M,j,R,E,D,w);else if("Binary"===j._bsontype)R=S(e,M,j,R);else if("Symbol"===j._bsontype)R=A(e,M,j,R);else if("DBRef"===j._bsontype)R=m(e,M,j,R,D,w);else if("BSONRegExp"===j._bsontype)R=c(e,M,j,R);else if("Int32"===j._bsontype)R=N(e,M,j,R);else if("MinKey"===j._bsontype||"MaxKey"===j._bsontype)R=h(e,M,j,R);else if(void 0!==j._bsontype)throw new TypeError("Unrecognized or invalid _bsontype: "+j._bsontype)}}}else{if(t.toBSON){if("function"!=typeof t.toBSON)throw new TypeError("toBSON is not a function");if(null!=(t=t.toBSON())&&"object"!=typeof t)throw new TypeError("toBSON function did not return an object")}for(const T in t){let L=t[T];if(L&&L.toBSON){if("function"!=typeof L.toBSON)throw new TypeError("toBSON is not a function");L=L.toBSON()}const M=typeof L;if("string"==typeof T&&!r.has(T)){if(null!=T.match(n))throw Error("key "+T+" must not contain null bytes");if(E){if("$"===T[0])throw Error("key "+T+" must not start with '$'");if(~T.indexOf("."))throw Error("key "+T+" must not contain '.'")}}if("string"===M)R=o(e,T,L,R);else if("number"===M)R=s(e,T,L,R);else{if("bigint"===M)throw new TypeError("Unsupported type BigInt, please use Decimal128");if("boolean"===M)R=f(e,T,L,R);else if(L instanceof Date||U.isDate(L))R=l(e,T,L,R);else if(void 0===L)!1===I&&(R=u(e,T,0,R));else if(null===L)R=u(e,T,0,R);else if("ObjectId"===L._bsontype||"ObjectID"===L._bsontype)R=_(e,T,L,R);else if(U.isBuffer(L)||U.isUint8Array(L))R=g(e,T,L,R);else if(L instanceof RegExp||i(L))R=a(e,T,L,R);else if("object"===M&&null==L._bsontype)R=d(e,T,L,R,E,D,w,I,!1,v);else if("object"===M&&"Decimal128"===L._bsontype)R=p(e,T,L,R);else if("Long"===L._bsontype||"Timestamp"===L._bsontype)R=B(e,T,L,R);else if("Double"===L._bsontype)R=O(e,T,L,R);else if("Code"===L._bsontype)R=y(e,T,L,R,E,D,w,I);else if("function"==typeof L&&w)R=b(e,T,L,R,E,D,w);else if("Binary"===L._bsontype)R=S(e,T,L,R);else if("Symbol"===L._bsontype)R=A(e,T,L,R);else if("DBRef"===L._bsontype)R=m(e,T,L,R,D,w);else if("BSONRegExp"===L._bsontype)R=c(e,T,L,R);else if("Int32"===L._bsontype)R=N(e,T,L,R);else if("MinKey"===L._bsontype||"MaxKey"===L._bsontype)R=h(e,T,L,R);else if(void 0!==L._bsontype)throw new TypeError("Unrecognized or invalid _bsontype: "+L._bsontype)}}}v.pop(),e[R++]=0;const L=R-T;return e[T++]=255&L,e[T++]=L>>8&255,e[T++]=L>>16&255,e[T++]=L>>24&255,R}t.serializeInto=E});n(ne);ne.serializeInto;var re=r(function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.deserializeStream=n.calculateObjectSize=n.deserialize=n.serializeWithBufferAndIndex=n.serialize=n.setInternalBufferSize=n.ObjectID=n.Decimal128=n.BSONRegExp=n.MaxKey=n.MinKey=n.Int32=n.Double=n.Timestamp=n.Long=n.ObjectId=n.Binary=n.DBRef=n.BSONSymbol=n.Map=n.Code=n.LongWithoutOverridesClass=n.EJSON=n.BSON_INT64_MIN=n.BSON_INT64_MAX=n.BSON_INT32_MIN=n.BSON_INT32_MAX=n.BSON_DATA_UNDEFINED=n.BSON_DATA_TIMESTAMP=n.BSON_DATA_SYMBOL=n.BSON_DATA_STRING=n.BSON_DATA_REGEXP=n.BSON_DATA_OID=n.BSON_DATA_OBJECT=n.BSON_DATA_NUMBER=n.BSON_DATA_NULL=n.BSON_DATA_MIN_KEY=n.BSON_DATA_MAX_KEY=n.BSON_DATA_LONG=n.BSON_DATA_INT=n.BSON_DATA_DECIMAL128=n.BSON_DATA_DBPOINTER=n.BSON_DATA_DATE=n.BSON_DATA_CODE_W_SCOPE=n.BSON_DATA_CODE=n.BSON_DATA_BOOLEAN=n.BSON_DATA_BINARY=n.BSON_DATA_ARRAY=n.BSON_BINARY_SUBTYPE_UUID_NEW=n.BSON_BINARY_SUBTYPE_UUID=n.BSON_BINARY_SUBTYPE_USER_DEFINED=n.BSON_BINARY_SUBTYPE_MD5=n.BSON_BINARY_SUBTYPE_FUNCTION=n.BSON_BINARY_SUBTYPE_DEFAULT=n.BSON_BINARY_SUBTYPE_BYTE_ARRAY=void 0,Object.defineProperty(n,"Binary",{enumerable:!0,get:function(){return x.Binary}}),Object.defineProperty(n,"Code",{enumerable:!0,get:function(){return P.Code}}),Object.defineProperty(n,"DBRef",{enumerable:!0,get:function(){return Y.DBRef}}),Object.defineProperty(n,"Decimal128",{enumerable:!0,get:function(){return C.Decimal128}}),Object.defineProperty(n,"Double",{enumerable:!0,get:function(){return z.Double}}),Object.defineProperty(n,"Int32",{enumerable:!0,get:function(){return J.Int32}}),Object.defineProperty(n,"Long",{enumerable:!0,get:function(){return $.Long}}),Object.defineProperty(n,"Map",{enumerable:!0,get:function(){return H.Map}}),Object.defineProperty(n,"MaxKey",{enumerable:!0,get:function(){return F.MaxKey}}),Object.defineProperty(n,"MinKey",{enumerable:!0,get:function(){return K.MinKey}}),Object.defineProperty(n,"ObjectId",{enumerable:!0,get:function(){return k.ObjectId}}),Object.defineProperty(n,"ObjectID",{enumerable:!0,get:function(){return k.ObjectId}}),Object.defineProperty(n,"BSONRegExp",{enumerable:!0,get:function(){return X.BSONRegExp}}),Object.defineProperty(n,"BSONSymbol",{enumerable:!0,get:function(){return V.BSONSymbol}}),Object.defineProperty(n,"Timestamp",{enumerable:!0,get:function(){return W.Timestamp}}),Object.defineProperty(n,"BSON_BINARY_SUBTYPE_BYTE_ARRAY",{enumerable:!0,get:function(){return q.BSON_BINARY_SUBTYPE_BYTE_ARRAY}}),Object.defineProperty(n,"BSON_BINARY_SUBTYPE_DEFAULT",{enumerable:!0,get:function(){return q.BSON_BINARY_SUBTYPE_DEFAULT}}),Object.defineProperty(n,"BSON_BINARY_SUBTYPE_FUNCTION",{enumerable:!0,get:function(){return q.BSON_BINARY_SUBTYPE_FUNCTION}}),Object.defineProperty(n,"BSON_BINARY_SUBTYPE_MD5",{enumerable:!0,get:function(){return q.BSON_BINARY_SUBTYPE_MD5}}),Object.defineProperty(n,"BSON_BINARY_SUBTYPE_USER_DEFINED",{enumerable:!0,get:function(){return q.BSON_BINARY_SUBTYPE_USER_DEFINED}}),Object.defineProperty(n,"BSON_BINARY_SUBTYPE_UUID",{enumerable:!0,get:function(){return q.BSON_BINARY_SUBTYPE_UUID}}),Object.defineProperty(n,"BSON_BINARY_SUBTYPE_UUID_NEW",{enumerable:!0,get:function(){return q.BSON_BINARY_SUBTYPE_UUID_NEW}}),Object.defineProperty(n,"BSON_DATA_ARRAY",{enumerable:!0,get:function(){return q.BSON_DATA_ARRAY}}),Object.defineProperty(n,"BSON_DATA_BINARY",{enumerable:!0,get:function(){return q.BSON_DATA_BINARY}}),Object.defineProperty(n,"BSON_DATA_BOOLEAN",{enumerable:!0,get:function(){return q.BSON_DATA_BOOLEAN}}),Object.defineProperty(n,"BSON_DATA_CODE",{enumerable:!0,get:function(){return q.BSON_DATA_CODE}}),Object.defineProperty(n,"BSON_DATA_CODE_W_SCOPE",{enumerable:!0,get:function(){return q.BSON_DATA_CODE_W_SCOPE}}),Object.defineProperty(n,"BSON_DATA_DATE",{enumerable:!0,get:function(){return q.BSON_DATA_DATE}}),Object.defineProperty(n,"BSON_DATA_DBPOINTER",{enumerable:!0,get:function(){return q.BSON_DATA_DBPOINTER}}),Object.defineProperty(n,"BSON_DATA_DECIMAL128",{enumerable:!0,get:function(){return q.BSON_DATA_DECIMAL128}}),Object.defineProperty(n,"BSON_DATA_INT",{enumerable:!0,get:function(){return q.BSON_DATA_INT}}),Object.defineProperty(n,"BSON_DATA_LONG",{enumerable:!0,get:function(){return q.BSON_DATA_LONG}}),Object.defineProperty(n,"BSON_DATA_MAX_KEY",{enumerable:!0,get:function(){return q.BSON_DATA_MAX_KEY}}),Object.defineProperty(n,"BSON_DATA_MIN_KEY",{enumerable:!0,get:function(){return q.BSON_DATA_MIN_KEY}}),Object.defineProperty(n,"BSON_DATA_NULL",{enumerable:!0,get:function(){return q.BSON_DATA_NULL}}),Object.defineProperty(n,"BSON_DATA_NUMBER",{enumerable:!0,get:function(){return q.BSON_DATA_NUMBER}}),Object.defineProperty(n,"BSON_DATA_OBJECT",{enumerable:!0,get:function(){return q.BSON_DATA_OBJECT}}),Object.defineProperty(n,"BSON_DATA_OID",{enumerable:!0,get:function(){return q.BSON_DATA_OID}}),Object.defineProperty(n,"BSON_DATA_REGEXP",{enumerable:!0,get:function(){return q.BSON_DATA_REGEXP}}),Object.defineProperty(n,"BSON_DATA_STRING",{enumerable:!0,get:function(){return q.BSON_DATA_STRING}}),Object.defineProperty(n,"BSON_DATA_SYMBOL",{enumerable:!0,get:function(){return q.BSON_DATA_SYMBOL}}),Object.defineProperty(n,"BSON_DATA_TIMESTAMP",{enumerable:!0,get:function(){return q.BSON_DATA_TIMESTAMP}}),Object.defineProperty(n,"BSON_DATA_UNDEFINED",{enumerable:!0,get:function(){return q.BSON_DATA_UNDEFINED}}),Object.defineProperty(n,"BSON_INT32_MAX",{enumerable:!0,get:function(){return q.BSON_INT32_MAX}}),Object.defineProperty(n,"BSON_INT32_MIN",{enumerable:!0,get:function(){return q.BSON_INT32_MIN}}),Object.defineProperty(n,"BSON_INT64_MAX",{enumerable:!0,get:function(){return q.BSON_INT64_MAX}}),Object.defineProperty(n,"BSON_INT64_MIN",{enumerable:!0,get:function(){return q.BSON_INT64_MIN}});var r=G;Object.defineProperty(n,"EJSON",{enumerable:!0,get:function(){return r.EJSON}});var i=W;Object.defineProperty(n,"LongWithoutOverridesClass",{enumerable:!0,get:function(){return i.LongWithoutOverridesClass}});const o=17825792;let s=e.Buffer.alloc(o);function u(t){s.length<t&&(s=e.Buffer.alloc(t))}function f(t,n={}){const r="boolean"==typeof n.checkKeys&&n.checkKeys,i="boolean"==typeof n.serializeFunctions&&n.serializeFunctions,u="boolean"!=typeof n.ignoreUndefined||n.ignoreUndefined,f="number"==typeof n.minInternalBufferSize?n.minInternalBufferSize:o;s.length<f&&(s=e.Buffer.alloc(f));const l=ne.serializeInto(s,t,r,0,0,i,u,[]),a=e.Buffer.alloc(l);return s.copy(a,0,0,a.length),a}function l(e,t,n={}){const r="boolean"==typeof n.checkKeys&&n.checkKeys,i="boolean"==typeof n.serializeFunctions&&n.serializeFunctions,o="boolean"!=typeof n.ignoreUndefined||n.ignoreUndefined,u="number"==typeof n.index?n.index:0,f=ne.serializeInto(s,e,r,0,0,i,o);return s.copy(t,u,0,f),u+f-1}function a(e,t={}){return ee.deserialize(M.ensureBuffer(e),t)}function c(e,t={}){const n="boolean"==typeof(t=t||{}).serializeFunctions&&t.serializeFunctions,r="boolean"!=typeof t.ignoreUndefined||t.ignoreUndefined;return Z.calculateObjectSize(e,n,r)}function h(e,t,n,r,i,o){const s=Object.assign({allowObjectSmallerThanBufferSize:!0,index:0},o),u=M.ensureBuffer(e);let f=t;for(let e=0;e<n;e++){const t=u[f]|u[f+1]<<8|u[f+2]<<16|u[f+3]<<24;s.index=f,r[i+e]=ee.deserialize(u,s),f+=t}return f}n.setInternalBufferSize=u,n.serialize=f,n.serializeWithBufferAndIndex=l,n.deserialize=a,n.calculateObjectSize=c,n.deserializeStream=h;const _={Binary:x.Binary,Code:P.Code,DBRef:Y.DBRef,Decimal128:C.Decimal128,Double:z.Double,Int32:J.Int32,Long:$.Long,Map:H.Map,MaxKey:F.MaxKey,MinKey:K.MinKey,ObjectId:k.ObjectId,ObjectID:k.ObjectId,BSONRegExp:X.BSONRegExp,BSONSymbol:V.BSONSymbol,Timestamp:W.Timestamp,EJSON:G.EJSON,setInternalBufferSize:u,serialize:f,serializeWithBufferAndIndex:l,deserialize:a,calculateObjectSize:c,deserializeStream:h};n.default=_}),ie=n(re),oe=re.deserializeStream,se=re.calculateObjectSize,ue=re.deserialize,fe=re.serializeWithBufferAndIndex,le=re.serialize,ae=re.setInternalBufferSize,ce=re.ObjectID,he=re.Decimal128,_e=re.BSONRegExp,ge=re.MaxKey,de=re.MinKey,pe=re.Int32,Be=re.Double,Ne=re.Timestamp,Oe=re.Long,be=re.ObjectId,ye=re.Binary,Se=re.DBRef,Ae=re.BSONSymbol,me=re.Map,Ee=re.Code,Te=re.LongWithoutOverridesClass,De=re.EJSON,we=re.BSON_INT64_MIN,Ie=re.BSON_INT64_MAX,ve=re.BSON_INT32_MIN,Re=re.BSON_INT32_MAX,Le=re.BSON_DATA_UNDEFINED,Ue=re.BSON_DATA_TIMESTAMP,Me=re.BSON_DATA_SYMBOL,je=re.BSON_DATA_STRING,xe=re.BSON_DATA_REGEXP,Pe=re.BSON_DATA_OID,Ye=re.BSON_DATA_OBJECT,$e=re.BSON_DATA_NUMBER,Ce=re.BSON_DATA_NULL,ze=re.BSON_DATA_MIN_KEY,Je=re.BSON_DATA_MAX_KEY,Fe=re.BSON_DATA_LONG,Ke=re.BSON_DATA_INT,ke=re.BSON_DATA_DECIMAL128,Xe=re.BSON_DATA_DBPOINTER,Ve=re.BSON_DATA_DATE,We=re.BSON_DATA_CODE_W_SCOPE,Ge=re.BSON_DATA_CODE,He=re.BSON_DATA_BOOLEAN,qe=re.BSON_DATA_BINARY,Ze=re.BSON_DATA_ARRAY,Qe=re.BSON_BINARY_SUBTYPE_UUID_NEW,et=re.BSON_BINARY_SUBTYPE_UUID,tt=re.BSON_BINARY_SUBTYPE_USER_DEFINED,nt=re.BSON_BINARY_SUBTYPE_MD5,rt=re.BSON_BINARY_SUBTYPE_FUNCTION,it=re.BSON_BINARY_SUBTYPE_DEFAULT,ot=re.BSON_BINARY_SUBTYPE_BYTE_ARRAY;export default ie;export{_e as BSONRegExp,Ae as BSONSymbol,ot as BSON_BINARY_SUBTYPE_BYTE_ARRAY,it as BSON_BINARY_SUBTYPE_DEFAULT,rt as BSON_BINARY_SUBTYPE_FUNCTION,nt as BSON_BINARY_SUBTYPE_MD5,tt as BSON_BINARY_SUBTYPE_USER_DEFINED,et as BSON_BINARY_SUBTYPE_UUID,Qe as BSON_BINARY_SUBTYPE_UUID_NEW,Ze as BSON_DATA_ARRAY,qe as BSON_DATA_BINARY,He as BSON_DATA_BOOLEAN,Ge as BSON_DATA_CODE,We as BSON_DATA_CODE_W_SCOPE,Ve as BSON_DATA_DATE,Xe as BSON_DATA_DBPOINTER,ke as BSON_DATA_DECIMAL128,Ke as BSON_DATA_INT,Fe as BSON_DATA_LONG,Je as BSON_DATA_MAX_KEY,ze as BSON_DATA_MIN_KEY,Ce as BSON_DATA_NULL,$e as BSON_DATA_NUMBER,Ye as BSON_DATA_OBJECT,Pe as BSON_DATA_OID,xe as BSON_DATA_REGEXP,je as BSON_DATA_STRING,Me as BSON_DATA_SYMBOL,Ue as BSON_DATA_TIMESTAMP,Le as BSON_DATA_UNDEFINED,Re as BSON_INT32_MAX,ve as BSON_INT32_MIN,Ie as BSON_INT64_MAX,we as BSON_INT64_MIN,ye as Binary,Ee as Code,Se as DBRef,he as Decimal128,Be as Double,De as EJSON,pe as Int32,Oe as Long,Te as LongWithoutOverridesClass,me as Map,ge as MaxKey,de as MinKey,ce as ObjectID,be as ObjectId,Ne as Timestamp,se as calculateObjectSize,ue as deserialize,oe as deserializeStream,le as serialize,fe as serializeWithBufferAndIndex,ae as setInternalBufferSize};