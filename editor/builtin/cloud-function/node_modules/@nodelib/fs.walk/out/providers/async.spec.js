"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("assert"),r=require("sinon"),t=require("../settings"),s=require("../tests"),a=require("./async");class d extends a.default{constructor(e,r=new t.default){super(e,r),this._reader=new s.TestAsyncReader}get reader(){return this._reader}}describe("Providers â†’ Async",()=>{describe(".read",()=>{it("should call reader function with correct set of arguments",()=>{const t=new d("directory"),s=r.stub();t.read(s),e.ok(t.reader.read.called)}),it("should call callback with error for failed launch",()=>{const t=new d("directory"),a=r.stub();t.reader.onError.yields(s.EPERM_ERRNO),t.read(a),e.deepStrictEqual(a.args,[[s.EPERM_ERRNO]])}),it("should push entries to storage and call callback with array of entries",()=>{const t=new d("directory"),a=s.buildFakeFileEntry(),i=r.stub();t.reader.onEntry.yields(a),t.reader.onEnd.yields(),t.read(i),e.deepStrictEqual(i.args,[[null,[a]]])})})});