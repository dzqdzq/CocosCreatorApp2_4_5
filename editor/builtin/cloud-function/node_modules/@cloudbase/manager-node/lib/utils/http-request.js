"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.fetchStream=exports.fetch=void 0;const t=require("url"),r=e(require("node-fetch")),o=e(require("https-proxy-agent")),n=require("../error");exports.fetch=async function(e,s={},a){(a||process.env.http_proxy)&&(s.agent=new o.default(a||process.env.http_proxy));const u=new t.URL(e).toString();let c,p;try{const e=await r.default(u,s);p=await e.text(),c=JSON.parse(p)}catch(e){if("SyntaxError"===e.name)throw new n.CloudBaseError(p);throw new n.CloudBaseError(e)}return c},exports.fetchStream=async function(e,n={},s){(s||process.env.http_proxy)&&(n.agent=new o.default(s||process.env.http_proxy));const a=new t.URL(e).toString();return r.default(a,n)};