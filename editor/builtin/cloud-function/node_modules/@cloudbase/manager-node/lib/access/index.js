"use strict";var e=this&&this.__decorate||function(e,t,s,n){var r,i=arguments.length,c=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,s):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,s,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(c=(i<3?r(c):i>3?r(t,s,c):r(t,s))||c);return i>3&&c&&Object.defineProperty(t,s,c),c};Object.defineProperty(exports,"__esModule",{value:!0}),exports.AccessService=void 0;const t=require("../utils");class s{constructor(e){this.environment=e,this.tcbService=new t.CloudService(e.cloudBaseContext,"tcb","2018-06-08")}async createAccess(e){const{path:t,name:s,type:n=1,auth:r}=e,{envId:i}=this.getEnvInfo();return this.tcbService.request("CreateCloudBaseGWAPI",{ServiceId:i,Path:t,Type:n,Name:s,AuthSwitch:r?1:2})}async getDomainList(){const{envId:e}=this.getEnvInfo();return this.tcbService.request("DescribeCloudBaseGWService",{ServiceId:e})}async getAccessList(e={}){const{path:t,name:s,offset:n,limit:r}=e,{envId:i}=this.getEnvInfo();return this.tcbService.request("DescribeCloudBaseGWAPI",{ServiceId:i,Path:t,Name:s,Offset:n,limit:r})}async switchAuth(e){const{envId:t}=this.getEnvInfo();return this.tcbService.request("ModifyCloudBaseGWPrivilege",{ServiceId:t,EnableService:e,Options:[{Key:"serviceswitch",Value:e?"true":"false"}]})}async switchPathAuth(e){const{apiIds:t,auth:s}=e,{envId:n}=this.getEnvInfo();return this.tcbService.request("ModifyCloudBaseGWAPIPrivilegeBatch",{ServiceId:n,APIIdSet:t,Options:[{Key:"authswitch",Value:s?"true":"false"}]})}async deleteAccess(e){const{name:t,type:s=1,apiId:n}=e,{envId:r}=this.getEnvInfo();return this.tcbService.request("DeleteCloudBaseGWAPI",{ServiceId:r,Name:t,Type:s,APIId:n})}async addCustomDomain(e){const{domain:t,certId:s}=e,{envId:n}=this.getEnvInfo();return this.tcbService.request("BindCloudBaseGWDomain",{Domain:t,ServiceId:n,CertId:s})}async deleteCustomDomain(e){const{envId:t}=this.getEnvInfo();return this.tcbService.request("DeleteCloudBaseGWDomain",{Domain:e,ServiceId:t})}getEnvInfo(){var e;const t=this.environment.lazyEnvironmentConfig,s=null===(e=t.Storages[0])||void 0===e?void 0:e.AppId,{proxy:n}=this.environment.cloudBaseContext;return{appId:s,proxy:n,envId:t.EnvId}}}e([t.preLazy()],s.prototype,"createAccess",null),e([t.preLazy()],s.prototype,"getDomainList",null),e([t.preLazy()],s.prototype,"getAccessList",null),e([t.preLazy()],s.prototype,"switchAuth",null),e([t.preLazy()],s.prototype,"switchPathAuth",null),e([t.preLazy()],s.prototype,"deleteAccess",null),e([t.preLazy()],s.prototype,"addCustomDomain",null),e([t.preLazy()],s.prototype,"deleteCustomDomain",null),exports.AccessService=s;