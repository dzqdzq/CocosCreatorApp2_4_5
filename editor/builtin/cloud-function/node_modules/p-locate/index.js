"use strict";const e=require("p-limit");class r extends Error{constructor(e){super(),this.value=e}}const s=(e,r)=>Promise.resolve(e).then(r),t=e=>Promise.all(e).then(e=>!0===e[1]&&Promise.reject(new r(e[0])));module.exports=((c,n,o)=>{o=Object.assign({concurrency:1/0,preserveOrder:!0},o);const i=e(o.concurrency),a=[...c].map(e=>[e,i(s,e,n)]),l=e(o.preserveOrder?1:1/0);return Promise.all(a.map(e=>l(t,e))).then(()=>{}).catch(e=>e instanceof r?e.value:Promise.reject(e))});